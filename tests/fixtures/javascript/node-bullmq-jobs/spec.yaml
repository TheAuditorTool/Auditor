name: node-bullmq-jobs
description: BullMQ job queue extraction test fixture
language: javascript

tables:
  bullmq_queues:
    min_rows: 1  # emailQueue
    queries:
      - name: verify_email_queue
        sql: SELECT * FROM bullmq_queues WHERE queue_name = 'emailQueue'
        expect_rows: 1

      - name: verify_redis_config
        sql: SELECT * FROM bullmq_queues WHERE redis_config IS NOT NULL
        expect_rows: 1

  bullmq_workers:
    min_rows: 1  # emailWorker
    queries:
      - name: verify_email_worker
        sql: SELECT * FROM bullmq_workers WHERE queue_name = 'emailQueue'
        expect_rows: 1

      - name: verify_worker_function
        sql: SELECT * FROM bullmq_workers WHERE worker_function IS NOT NULL
        expect_rows: 1