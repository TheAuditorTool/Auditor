{
  "timestamp": "2025-11-27T16:40:39.581945+00:00",
  "duration_seconds": 1.7470077000034507,
  "total_commands": 73,
  "total_groups": 10,
  "tests_run": 73,
  "summary": {
    "help_pass": 73,
    "help_fail": 0,
    "help_timeout": 0,
    "no_args_pass": 0,
    "no_args_fail": 0,
    "no_args_timeout": 0,
    "no_args_expected_fail": 0,
    "fixture_pass": 0,
    "fixture_fail": 0
  },
  "failures": [],
  "regressions": [],
  "improvements": [],
  "environment": {
    "python_version": "3.14.0 (tags/v3.14.0:ebf955d, Oct  7 2025, 10:15:03) [MSC v.1944 64 bit (AMD64)]",
    "platform": "win32",
    "cwd": "C:\\Users\\santa\\Desktop\\TheAuditor",
    "parallel_workers": 1,
    "quick_mode": true
  },
  "commands": [
    {
      "command": "aud _archive",
      "is_group": false,
      "params": [
        {
          "name": "run_type",
          "param_type": "Option",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Type of run being archived",
          "choices": [
            "full",
            "diff"
          ]
        },
        {
          "name": "diff_spec",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Git diff specification for diff runs (e.g., main..HEAD)",
          "choices": null
        },
        {
          "name": "wipe_cache",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Delete caches during archive (default: preserve)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.2258999922778457,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli _archive [OPTIONS]\n\n  Internal command to archive previous run artifacts with segregation by type.\n\n  This command is not intended for direct user execution. It's called by the\n  full and orchestrate workflows to maintain clean, segregated history.\n\n  Cache Preservation: By default, caches (.cache/, context/) are PRESERVED to\n  speed up subsequent runs. Use --wipe-cache to force deletion (useful for cache\n  corruption recovery).\n\n  Preserved by default: - .pf/.cache/ (AST parsing cache) - .pf/context/\n  (documentation cache and summaries)\n\n  Always archived: - .pf/raw/ (raw tool outputs) - .pf/readthis/ (AI-consumable\n  chunks) - All other .pf/ contents\n\nOptions:\n  --run-type [full|diff]  Type of run being archived  [required]\n  --diff-spec TEXT        Git diff specification for diff runs (e.g.,\n                          main..HEAD)\n  --wipe-cache            Delete caches during archive (default: preserve)\n  --help                  Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.6171000024769455
    },
    {
      "command": "aud blueprint",
      "is_group": false,
      "params": [
        {
          "name": "structure",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Drill down into codebase structure details",
          "choices": null
        },
        {
          "name": "graph",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Drill down into import/call graph analysis",
          "choices": null
        },
        {
          "name": "security",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Drill down into security surface details",
          "choices": null
        },
        {
          "name": "taint",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Drill down into taint analysis details",
          "choices": null
        },
        {
          "name": "boundaries",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Drill down into boundary distance analysis",
          "choices": null
        },
        {
          "name": "deps",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Drill down into dependency analysis (packages, versions)",
          "choices": null
        },
        {
          "name": "all",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Export all data to JSON (ignores other flags)",
          "choices": null
        },
        {
          "name": "output_format",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "text",
          "help_text": "Output format: text (visual tree), json (structured)",
          "choices": [
            "text",
            "json"
          ]
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.0636999795679003,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli blueprint [OPTIONS]\n\n  Architectural fact visualization with drill-down analysis modes (NO\n  recommendations).\n\n  Truth-courier mode visualization that presents pure architectural facts\n  extracted from indexed codebase with zero prescriptive language. Supports\n  drill-down flags to focus on specific dimensions (structure, dependencies,\n  security surface, data flow). Output format toggles between visual ASCII tree\n  and structured JSON for programmatic consumption.\n\n  AI ASSISTANT CONTEXT:   Purpose: Visualize codebase architecture facts (no\n  recommendations)   Input: .pf/repo_index.db (indexed code)   Output: Terminal\n  tree or JSON (configurable via --format)   Prerequisites: aud index (populates\n  database)   Integration: Architecture documentation, onboarding, refactoring\n  planning   Performance: ~2-5 seconds (database queries + formatting)\n\n  DRILL-DOWN MODES:   (default): Top-level overview     - Module count, file\n  organization tree     - High-level statistics onl",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.4290999970398843
    },
    {
      "command": "aud boundaries",
      "is_group": false,
      "params": [
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Path to repo_index.db (default: .pf/repo_index.db)",
          "choices": null
        },
        {
          "name": "boundary_type",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "all",
          "help_text": "Boundary type to analyze",
          "choices": [
            "all",
            "input-validation",
            "multi-tenant",
            "authorization",
            "sanitization"
          ]
        },
        {
          "name": "output_format",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "report",
          "help_text": "Output format (report=human-readable, json=machine-parseable)",
          "choices": [
            "report",
            "json"
          ]
        },
        {
          "name": "max_entries",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 100,
          "help_text": "Maximum entry points to analyze (performance limit)",
          "choices": null
        },
        {
          "name": "severity",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "all",
          "help_text": "Filter findings by severity",
          "choices": [
            "all",
            "critical",
            "high",
            "medium",
            "low"
          ]
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.7670999804977328,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli boundaries [OPTIONS]\n\n  Analyze security boundary enforcement and measure distance from entry to\n  control points.\n\n  Detects where security controls (validation, authentication, sanitization) are\n  enforced relative to entry points. Reports factual distance measurements - NOT\n  recommendations.\n\n  CRITICAL CONCEPTS:   Boundary: Point where trust level changes\n  (external->internal, untrusted->validated)   Distance: Number of function\n  calls between entry point and control point   Entry Point: HTTP route, CLI\n  command, message handler (external data ingress)   Control Point: Validation,\n  authentication, sanitization (security enforcement)\n\n  DISTANCE SEMANTICS:   Distance 0: Control at entry (validation in function\n  signature)   Distance 1-2: Control nearby (acceptable for most boundaries)\n  Distance 3+: Control far from entry (data spreads before enforcement)\n  Distance None: No control found (missing boundary enforcement)\n\n  AI ASSISTANT CONTEXT:   Purpose: Measure bou",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 2.130900014890358
    },
    {
      "command": "aud cdk analyze",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory to analyze",
          "choices": null
        },
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/repo_index.db",
          "help_text": "Source database path",
          "choices": null
        },
        {
          "name": "severity",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "all",
          "help_text": "Filter by severity (critical, high, medium, low, all)",
          "choices": null
        },
        {
          "name": "output_format",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "text",
          "help_text": "Output format (text, json)",
          "choices": null
        },
        {
          "name": "output",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Output file path (default: stdout)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.747200014302507,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli cdk analyze [OPTIONS]\n\n  Detect AWS CDK infrastructure security issues.\n\n  Analyzes CDK constructs and writes findings to cdk_findings database table.\n  Stdout/JSON output is for human consumption only - AI should query database.\n\n  Detection Categories:   - Publicly accessible resources (S3, RDS, etc.)   -\n  Missing encryption configurations   - Overly permissive network rules\n  (security groups)   - Excessive IAM permissions (wildcard policies)\n\n  Examples:   aud cdk analyze                          # All findings   aud cdk\n  analyze --severity high          # High+ severity only   aud cdk analyze\n  --format json            # JSON output (human report)   aud cdk analyze\n  --output cdk_report.json # Write to file\n\n  For AI Integration:   Step 1: Run analysis (writes to database)     aud cdk\n  analyze\n\n    Step 2: Query database (DO NOT parse stdout!)     SELECT * FROM cdk_findings\n    WHERE severity='critical';\n\n  Exit Codes:   0 = No security issues found   1 = Security is",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.0185999854002148
    },
    {
      "command": "aud cfg analyze",
      "is_group": false,
      "params": [
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".pf/repo_index.db",
          "help_text": "Path to repository database",
          "choices": null
        },
        {
          "name": "file",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Analyze specific file only",
          "choices": null
        },
        {
          "name": "function",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Analyze specific function only",
          "choices": null
        },
        {
          "name": "complexity_threshold",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 10,
          "help_text": "Complexity threshold for reporting",
          "choices": null
        },
        {
          "name": "output",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/raw/cfg_analysis.json",
          "help_text": "Output JSON file path",
          "choices": null
        },
        {
          "name": "find_dead_code",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Find unreachable code blocks",
          "choices": null
        },
        {
          "name": "workset",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Analyze workset files only",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.5704999784938991,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli cfg analyze [OPTIONS]\n\n  Analyze control flow complexity and find issues.\n\n  Examples:     # Analyze all functions for high complexity     aud cfg analyze\n  --complexity-threshold 15          # Find dead code in specific file     aud\n  cfg analyze --file src/auth.py --find-dead-code          # Analyze specific\n  function     aud cfg analyze --function process_payment --output\n  payment_cfg.json\n\nOptions:\n  --db TEXT                       Path to repository database\n  --file TEXT                     Analyze specific file only\n  --function TEXT                 Analyze specific function only\n  --complexity-threshold INTEGER  Complexity threshold for reporting\n  --output TEXT                   Output JSON file path\n  --find-dead-code                Find unreachable code blocks\n  --workset                       Analyze workset files only\n  --help                          Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.8719000034034252
    },
    {
      "command": "aud cfg viz",
      "is_group": false,
      "params": [
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".pf/repo_index.db",
          "help_text": "Path to repository database",
          "choices": null
        },
        {
          "name": "file",
          "param_type": "Option",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "File containing the function",
          "choices": null
        },
        {
          "name": "function",
          "param_type": "Option",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Function name to visualize",
          "choices": null
        },
        {
          "name": "output",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Output file path (default: function_name.dot)",
          "choices": null
        },
        {
          "name": "format",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "dot",
          "help_text": "Output format",
          "choices": [
            "dot",
            "svg",
            "png"
          ]
        },
        {
          "name": "show_statements",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Include statements in blocks",
          "choices": null
        },
        {
          "name": "highlight_paths",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Highlight execution paths",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.756499997805804,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli cfg viz [OPTIONS]\n\n  Visualize control flow graph for a function.\n\n  Examples:     # Generate DOT file for a function     aud cfg viz --file\n  src/auth.py --function validate_token          # Generate SVG with statements\n  shown     aud cfg viz --file src/payment.py --function process_payment\n  --format svg --show-statements          # Highlight execution paths     aud\n  cfg viz --file src/api.py --function handle_request --highlight-paths\n\nOptions:\n  --db TEXT               Path to repository database\n  --file TEXT             File containing the function  [required]\n  --function TEXT         Function name to visualize  [required]\n  --output TEXT           Output file path (default: function_name.dot)\n  --format [dot|svg|png]  Output format\n  --show-statements       Include statements in blocks\n  --highlight-paths       Highlight execution paths\n  --help                  Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.0402000043541193
    },
    {
      "command": "aud context",
      "is_group": false,
      "params": [
        {
          "name": "context_file",
          "param_type": "Option",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Semantic context YAML file",
          "choices": null
        },
        {
          "name": "output",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Custom output JSON file (optional)",
          "choices": null
        },
        {
          "name": "verbose",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show detailed findings in report",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.2672999873757362,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli context [OPTIONS]\n\n  Apply user-defined semantic rules to classify findings based on business logic\n  and refactoring context.\n\n  Enables project-specific interpretation of analysis findings through YAML\n  rules that classify issues as obsolete (needs immediate fix), current (correct\n  pattern), or transitional (acceptable during migration). Essential for\n  refactoring workflows where temporary inconsistencies are expected (e.g.,\n  OAuth migration makes JWT findings obsolete, but old endpoints still exist\n  during transition).\n\n  AI ASSISTANT CONTEXT:   Purpose: Semantic classification of findings based on\n  business context   Input: context.yaml (rules), .pf/raw/*.json (analysis\n  findings)   Output: .pf/raw/context_report.json (classified findings)\n  Prerequisites: aud full or aud detect-patterns (populates findings)\n  Integration: Refactoring workflows, technical debt tracking, migration\n  planning   Performance: ~1-3 seconds (YAML parsing + finding classification)\n\n  WHA",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.6118000203277916
    },
    {
      "command": "aud deadcode",
      "is_group": false,
      "params": [
        {
          "name": "project_path",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory to analyze",
          "choices": null
        },
        {
          "name": "path_filter",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Only analyze paths matching filter (e.g., 'theauditor/%')",
          "choices": null
        },
        {
          "name": "exclude",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": [
            "test",
            "__tests__",
            "migrations",
            "node_modules",
            ".venv"
          ],
          "help_text": "Exclude paths matching patterns",
          "choices": null
        },
        {
          "name": "format",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "text",
          "help_text": "Output format",
          "choices": [
            "text",
            "json",
            "summary"
          ]
        },
        {
          "name": "save",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Save output to file",
          "choices": null
        },
        {
          "name": "fail_on_dead_code",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Exit 1 if dead code found",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.2744999839924276,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli deadcode [OPTIONS]\n\n  Detect isolated modules, unreachable functions, and never-imported code.\n\n  Identifies dead code by analyzing the import graph - any module with symbols\n  (functions, classes) that is never imported is potentially dead. Uses\n  database-only analysis (no AST reparsing) with confidence classification to\n  reduce false positives from entry points, tests, and CLI scripts.\n\n  AI ASSISTANT CONTEXT:   Purpose: Finds unused code (modules, functions) that\n  can be safely removed   Input: .pf/repo_index.db (symbols and refs tables)\n  Output: List of isolated modules with confidence levels   Prerequisites: aud\n  index (populates import graph in database)   Integration: Code cleanup\n  workflow, technical debt reduction   Performance: ~1-2 seconds (pure database\n  query, no file I/O)\n\n  WHAT IT DETECTS:   Isolated Modules:     - Python files with functions/classes\n  never imported anywhere     - JavaScript modules with exports never imported\n  - Entire features impl",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.565599988680333
    },
    {
      "command": "aud deps",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory",
          "choices": null
        },
        {
          "name": "check_latest",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Check for latest versions from registries",
          "choices": null
        },
        {
          "name": "upgrade_all",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "YOLO mode: Update ALL packages to latest versions",
          "choices": null
        },
        {
          "name": "upgrade_py",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Upgrade Python deps (requirements*.txt + pyproject.toml)",
          "choices": null
        },
        {
          "name": "upgrade_npm",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Upgrade npm deps (package.json files)",
          "choices": null
        },
        {
          "name": "upgrade_docker",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Upgrade Docker images (docker-compose*.yml + Dockerfile)",
          "choices": null
        },
        {
          "name": "upgrade_cargo",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Upgrade Rust deps (Cargo.toml)",
          "choices": null
        },
        {
          "name": "allow_prerelease",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Allow alpha/beta/rc versions (default: stable only)",
          "choices": null
        },
        {
          "name": "offline",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Force offline mode (no network)",
          "choices": null
        },
        {
          "name": "out",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/raw/deps.json",
          "help_text": "Output dependencies file",
          "choices": null
        },
        {
          "name": "print_stats",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Print dependency statistics",
          "choices": null
        },
        {
          "name": "vuln_scan",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Scan dependencies for known vulnerabilities",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.8910000033210963,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli deps [OPTIONS]\n\n  Analyze dependencies for vulnerabilities and updates.\n\n  Comprehensive dependency analysis supporting Python (pip/poetry) and\n  JavaScript/TypeScript (npm/yarn). Can check for outdated packages, known\n  vulnerabilities, and selectively upgrade by ecosystem.\n\n  Supported Files:   - package.json / package-lock.json (npm/yarn)   -\n  pyproject.toml (Poetry/setuptools)   - requirements.txt / requirements-*.txt\n  (pip)   - setup.py / setup.cfg (setuptools)   - docker-compose*.yml /\n  Dockerfile (Docker)   - Cargo.toml (Rust)\n\n  Operation Modes:   Default:        Parse and inventory all dependencies\n  --check-latest: Check for available updates (grouped by file)   --vuln-scan:\n  Run security scanners (npm audit + OSV-Scanner)   --upgrade-all:  YOLO mode -\n  upgrade everything to latest\n\n  Selective Upgrades (use after --check-latest to see what's outdated):\n  --upgrade-py:     Only requirements*.txt + pyproject.toml   --upgrade-npm:\n  Only package.json files   --u",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.2009000056423247
    },
    {
      "command": "aud detect-frameworks",
      "is_group": false,
      "params": [
        {
          "name": "project_path",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory to analyze",
          "choices": null
        },
        {
          "name": "output_json",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Path to output JSON file (default: .pf/raw/frameworks.json)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.3968999846838415,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli detect-frameworks [OPTIONS]\n\n  Display detected frameworks from indexed codebase in AI-consumable format.\n\n  Reads framework metadata from the database (populated during 'aud index') and\n  outputs structured JSON for AI assistant consumption. This command is\n  database-only - it does NOT re-parse manifests or analyze source code. The\n  database is the single source of truth.\n\n  AI ASSISTANT CONTEXT:   Purpose: Exposes detected frameworks/libraries for\n  architecture understanding   Input: .pf/repo_index.db (frameworks table)\n  Output: .pf/raw/frameworks.json (structured framework list)   Prerequisites:\n  aud index (must run first to populate database)   Integration: Used by\n  blueprint and structure commands for architecture visualization   Performance:\n  ~1 second (database query only, no file I/O)\n\n  WHAT IT DETECTS:   - Python frameworks: Flask, Django, FastAPI, SQLAlchemy,\n  Celery, pytest   - JavaScript frameworks: React, Vue, Angular, Express,\n  Nest.js, Next.js   - Da",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.6843000194057822
    },
    {
      "command": "aud detect-patterns",
      "is_group": false,
      "params": [
        {
          "name": "project_path",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory to analyze",
          "choices": null
        },
        {
          "name": "patterns",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Pattern categories to use (e.g., runtime_issues, db_issues)",
          "choices": null
        },
        {
          "name": "output_json",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Path to output JSON file",
          "choices": null
        },
        {
          "name": "file_filter",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Glob pattern to filter files",
          "choices": null
        },
        {
          "name": "max_rows",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 50,
          "help_text": "Maximum rows to display in table",
          "choices": null
        },
        {
          "name": "print_stats",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Print summary statistics",
          "choices": null
        },
        {
          "name": "with_ast",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": true,
          "help_text": "Enable AST-based pattern matching",
          "choices": null
        },
        {
          "name": "with_frameworks",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": true,
          "help_text": "Enable framework detection and framework-specific patterns",
          "choices": null
        },
        {
          "name": "exclude_self",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Exclude TheAuditor's own files (for self-testing)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.884400011273101,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli detect-patterns [OPTIONS]\n\n  Detect security vulnerabilities and code quality issues.\n\n  Runs 100+ security pattern rules across your codebase using both regex and\n  AST-based detection. Covers OWASP Top 10, CWE Top 25, and framework-specific\n  vulnerabilities.\n\n  Pattern Categories:   Authentication:     - Hardcoded credentials and API keys\n  - Weak password validation     - Missing authentication checks     - Insecure\n  session management\n\n    Injection Attacks:     - SQL injection vulnerabilities     - Command\n    injection risks     - XSS (Cross-Site Scripting)     - Template injection\n    - LDAP/NoSQL injection\n\n    Data Security:     - Exposed sensitive data     - Insecure cryptography\n    - Weak random number generation     - Missing encryption\n\n    Infrastructure:     - Debug mode in production     - Insecure CORS\n    configuration     - Missing security headers     - Exposed admin interfaces\n\n    Code Quality:     - Race conditions     - Resource leaks     - Infinit",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.1832999880425632
    },
    {
      "command": "aud docker-analyze",
      "is_group": false,
      "params": [
        {
          "name": "db_path",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/repo_index.db",
          "help_text": "Path to repo_index.db",
          "choices": null
        },
        {
          "name": "output",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Output file for findings (JSON format)",
          "choices": null
        },
        {
          "name": "severity",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "all",
          "help_text": "Minimum severity to report",
          "choices": [
            "all",
            "critical",
            "high",
            "medium",
            "low"
          ]
        },
        {
          "name": "check_vulns",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": true,
          "help_text": "Check base images for vulnerabilities (requires network)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.3860999897588044,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli docker-analyze [OPTIONS]\n\n  Analyze Dockerfiles and container images for security vulnerabilities and\n  misconfigurations.\n\n  Performs static analysis on Dockerfiles to detect common security issues\n  including privilege escalation risks, exposed secrets, insecure base images,\n  and container hardening failures. Optionally checks base images against\n  vulnerability databases (requires network).\n\n  AI ASSISTANT CONTEXT:   Purpose: Identifies Docker security issues and\n  container misconfigurations   Input: .pf/repo_index.db (Dockerfile contents\n  indexed by 'aud index')   Output: .pf/raw/docker_findings.json (security\n  issues with severity)   Prerequisites: aud index (populates database with\n  Dockerfile contents)   Integration: Part of security audit workflow, runs in\n  'aud full' pipeline   Performance: ~2-5 seconds local analysis, +10-30s if\n  checking vulnerabilities\n\n  WHAT IT DETECTS:   Privilege Escalation:     - USER root instructions\n  (containers running as root)  ",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.6826000064611435
    },
    {
      "command": "aud docs",
      "is_group": false,
      "params": [
        {
          "name": "action",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": [
            "fetch",
            "view",
            "list"
          ]
        },
        {
          "name": "package_name",
          "param_type": "Argument",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "deps",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/deps.json",
          "help_text": "Input dependencies file",
          "choices": null
        },
        {
          "name": "offline",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Force offline mode",
          "choices": null
        },
        {
          "name": "allow_non_gh_readmes",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Allow non-GitHub README fetching",
          "choices": null
        },
        {
          "name": "docs_dir",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/context/docs",
          "help_text": "Documentation cache directory",
          "choices": null
        },
        {
          "name": "print_stats",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Print statistics",
          "choices": null
        },
        {
          "name": "raw",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "View raw fetched doc instead of capsule",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.4479000237770379,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli docs [OPTIONS] {fetch|view|list} [PACKAGE_NAME]\n\n  Fetch, cache, and summarize external library documentation for AI-consumable\n  context.\n\n  Downloads README files and API documentation from package repositories (PyPI,\n  npm), caches locally for offline use, and generates condensed \"documentation\n  capsules\" optimized for LLM context windows. Enables AI assistants to\n  understand library APIs without requiring internet access during analysis.\n\n  AI ASSISTANT CONTEXT:   Purpose: Provide external library documentation for AI\n  code understanding   Input: .pf/deps.json (detected dependencies), package\n  repository metadata   Output: .pf/context/docs/ (raw docs),\n  .pf/context/doc_capsules/ (AI-optimized)   Prerequisites: aud deps (detects\n  dependencies first)   Integration: Documentation context for AI code review\n  and refactoring   Performance: ~5-30 seconds (network-dependent, cached after\n  first fetch)\n\n  ACTIONS SUPPORTED:   fetch:     - Downloads README files from GitH",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.7325000080745667
    },
    {
      "command": "aud explain",
      "is_group": false,
      "params": [
        {
          "name": "target",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "depth",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 1,
          "help_text": "Call graph depth for callers/callees (1-5, default=1)",
          "choices": null
        },
        {
          "name": "output_format",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "text",
          "help_text": "Output format: text (human), json (AI)",
          "choices": [
            "text",
            "json"
          ]
        },
        {
          "name": "section",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "all",
          "help_text": "Show only specific section",
          "choices": [
            "all",
            "symbols",
            "hooks",
            "deps",
            "callers",
            "callees"
          ]
        },
        {
          "name": "no_code",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Disable code snippets (faster output)",
          "choices": null
        },
        {
          "name": "limit",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 20,
          "help_text": "Max items per section (default=20)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.850699987495318,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli explain [OPTIONS] TARGET\n\n  Get comprehensive context about a file, symbol, or component.\n\n  Provides a complete \"briefing packet\" in ONE command, eliminating the need to\n  run multiple queries or read entire files. Optimized for AI workflows.\n\n  TARGET can be:\n\n    File path:     aud explain src/auth.ts\n    Symbol:        aud explain authenticateUser\n    Class.method:  aud explain UserController.create\n    Component:     aud explain Dashboard\n\n  WHAT IT RETURNS:\n\n    For files:     - SYMBOLS DEFINED: All functions, classes, variables with\n    line numbers     - HOOKS USED: React/Vue hooks (if applicable)     -\n    DEPENDENCIES: Files imported by this file     - DEPENDENTS: Files that\n    import this file     - OUTGOING CALLS: Functions called from this file     -\n    INCOMING CALLS: Functions in this file called elsewhere\n\n    For symbols:     - DEFINITION: File, line, type, signature     - CALLERS:\n    Who calls this symbol     - CALLEES: What this symbol calls\n\n    For co",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.1996000248473138
    },
    {
      "command": "aud fce",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory",
          "choices": null
        },
        {
          "name": "capsules",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/capsules",
          "help_text": "Capsules directory",
          "choices": null
        },
        {
          "name": "manifest",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "manifest.json",
          "help_text": "Manifest file path",
          "choices": null
        },
        {
          "name": "workset",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/workset.json",
          "help_text": "Workset file path",
          "choices": null
        },
        {
          "name": "timeout",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 600,
          "help_text": "Timeout in seconds",
          "choices": null
        },
        {
          "name": "print_plan",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Print detected tools without running",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.503499981481582,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli fce [OPTIONS]\n\n  Cross-reference findings to identify compound vulnerabilities.\n\n  The Factual Correlation Engine (FCE) is TheAuditor's advanced analysis system\n  that correlates findings from multiple tools to detect complex vulnerability\n  patterns that single tools miss. It identifies when multiple \"low severity\"\n  issues combine to create critical risks.\n\n  Correlation Rules (30 Advanced Patterns):   Authentication & Authorization:\n  - Missing auth + exposed endpoints = Critical     - Weak passwords + no rate\n  limiting = High risk     - Session fixation + XSS = Session hijacking\n\n    Injection Combinations:     - User input + SQL queries + no validation = SQL\n    injection     - File upload + path traversal = Remote code execution     -\n    Template injection + user data = XSS\n\n    Data Exposure:     - Debug mode + error messages = Information disclosure\n    - Hardcoded secrets + public repo = Credential leak     - Missing encryption\n    + sensitive data = Data breach\n\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.8797000229824334
    },
    {
      "command": "aud full",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory to analyze",
          "choices": null
        },
        {
          "name": "quiet",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Minimal output",
          "choices": null
        },
        {
          "name": "exclude_self",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Exclude TheAuditor's own files (for self-testing)",
          "choices": null
        },
        {
          "name": "offline",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Skip network operations (deps, docs)",
          "choices": null
        },
        {
          "name": "subprocess_taint",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Run taint analysis as subprocess (slower but isolated)",
          "choices": null
        },
        {
          "name": "wipecache",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Delete all caches before run (for cache corruption recovery)",
          "choices": null
        },
        {
          "name": "index_only",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Run indexing only (Stage 1 + 2) - skip heavy analysis",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.2935000122524798,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli full [OPTIONS]\n\n  Run comprehensive security audit pipeline (20 phases).\n\n  Executes TheAuditor's complete analysis pipeline in 4 optimized stages with\n  intelligent parallelization. This is your main command for full codebase\n  auditing.\n\n  Pipeline Stages:   Stage 1: Foundation (Sequential)     - Index repository\n  (build symbol database)     - Detect frameworks (Django, Flask, React, etc.)\n\n    Stage 2: Data Preparation (Sequential)     - Create workset (identify\n    analysis targets)     - Build dependency graph     - Extract control flow\n    graphs\n\n    Stage 3: Heavy Analysis (3 Parallel Tracks)     Track A: Taint analysis\n    (isolated for performance)     Track B: Static analysis & offline security\n    (lint, patterns, graph, vuln-scan)     Track C: Network I/O (version checks,\n    docs) - skipped if --offline\n\n    Stage 4: Aggregation (Sequential)     - Factual Correlation Engine (cross-\n    reference findings)     - Generate final report\n\n  Examples:   aud full    ",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.6234999930020422
    },
    {
      "command": "aud graph analyze",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory",
          "choices": null
        },
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/graphs.db",
          "help_text": "SQLite database path",
          "choices": null
        },
        {
          "name": "out",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/raw/graph_analysis.json",
          "help_text": "Output JSON path",
          "choices": null
        },
        {
          "name": "max_depth",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 3,
          "help_text": "Max traversal depth for impact analysis",
          "choices": null
        },
        {
          "name": "workset",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Path to workset.json for change impact",
          "choices": null
        },
        {
          "name": "no_insights",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Skip interpretive insights (health scores, recommendations)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.0278999980073422,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli graph analyze [OPTIONS]\n\n  Analyze dependency graphs for architectural issues and change impact.\n\n  Performs comprehensive graph analysis to detect circular dependencies,\n  architectural hotspots, and measure the blast radius of code changes.\n  Generates health metrics and recommendations for improving codebase\n  architecture.\n\n  AI ASSISTANT CONTEXT:   Purpose: Detect architectural issues via graph\n  analysis   Input: .pf/graphs.db (import and call graphs from 'aud graph\n  build')   Output: .pf/raw/graph_analysis.json (cycles, hotspots, health\n  metrics)   Prerequisites: aud index, aud graph build   Integration:\n  Architecture reviews, refactoring planning, impact analysis   Performance:\n  ~3-10 seconds (graph traversal + metrics calculation)\n\n  ANALYSIS PERFORMED:   Cycle Detection:     - Identifies circular import\n  dependencies     - Ranks cycles by size and complexity     - Highlights most\n  problematic cycles\n\n    Hotspot Ranking:     - Finds highly connected modules (",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.3812000106554478
    },
    {
      "command": "aud graph build",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory to analyze",
          "choices": null
        },
        {
          "name": "langs",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Languages to process (e.g., python, javascript)",
          "choices": null
        },
        {
          "name": "workset",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Path to workset.json to limit scope",
          "choices": null
        },
        {
          "name": "batch_size",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 200,
          "help_text": "Files per batch",
          "choices": null
        },
        {
          "name": "resume",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Resume from checkpoint",
          "choices": null
        },
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/graphs.db",
          "help_text": "SQLite database path",
          "choices": null
        },
        {
          "name": "out_json",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/raw/",
          "help_text": "JSON output directory",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.9615000162739307,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli graph build [OPTIONS]\n\n  Build import and call graphs from your codebase.\n\n  Constructs two types of graphs: 1. Import Graph: Shows module/file\n  dependencies (who imports what) 2. Call Graph: Shows function relationships\n  (who calls what)\n\n  These graphs are the foundation for architectural analysis, cycle detection,\n  and impact measurement.\n\n  Examples:   aud graph build                         # Full codebase   aud\n  graph build --langs python          # Python only   aud graph build --workset\n  workset.json  # Specific files   aud graph build --resume                #\n  Resume interrupted build\n\n  Output:   .pf/graphs.db - SQLite database containing:     - import_nodes:\n  Files and modules     - import_edges: Import relationships     - call_nodes:\n  Functions and methods     - call_edges: Call relationships\n\n  FLAG INTERACTIONS:   --workset + --langs: Analyze specific files in specific\n  languages only   --resume: Safe to use after interrupted builds (preserves\n  parti",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.3024999934714288
    },
    {
      "command": "aud graph build-dfg",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory",
          "choices": null
        },
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/graphs.db",
          "help_text": "SQLite database path",
          "choices": null
        },
        {
          "name": "repo_db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/repo_index.db",
          "help_text": "Repo index database",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.7847000088077039,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli graph build-dfg [OPTIONS]\n\n  Build data flow graph from indexed assignments and returns.\n\n  Constructs a data flow graph showing how data flows through variable\n  assignments and function returns. Uses normalized junction tables\n  (assignment_sources, function_return_sources) for accurate tracking.\n\n  Must run 'aud index' first to populate junction tables.\n\n  Examples:   aud graph build-dfg                  # Build DFG from current\n  project\n\n  Output:   .pf/graphs.db - SQLite database with:     - nodes\n  (graph_type='data_flow'): Variables and return values     - edges\n  (graph_type='data_flow'): Assignment and return relationships\n\n  Stats shown:   - Total assignments processed   - Assignments with source\n  variables   - Edges created   - Unique variables tracked\n\nOptions:\n  --root TEXT     Root directory\n  --db TEXT       SQLite database path\n  --repo-db TEXT  Repo index database\n  --help          Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.1209000076632947
    },
    {
      "command": "aud graph query",
      "is_group": false,
      "params": [
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/graphs.db",
          "help_text": "SQLite database path",
          "choices": null
        },
        {
          "name": "uses",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Find who uses/imports this module or calls this function",
          "choices": null
        },
        {
          "name": "calls",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Find what this module/function calls or depends on",
          "choices": null
        },
        {
          "name": "nearest_path",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Find shortest path between two nodes",
          "choices": null
        },
        {
          "name": "format",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "table",
          "help_text": "Output format",
          "choices": [
            "table",
            "json"
          ]
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.698099989676848,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli graph query [OPTIONS]\n\n  Query graph relationships.\n\nOptions:\n  --db TEXT               SQLite database path\n  --uses TEXT             Find who uses/imports this module or calls this\n                          function\n  --calls TEXT            Find what this module/function calls or depends on\n  --nearest-path TEXT...  Find shortest path between two nodes\n  --format [table|json]   Output format\n  --help                  Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.054599997587502
    },
    {
      "command": "aud graph viz",
      "is_group": false,
      "params": [
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/graphs.db",
          "help_text": "SQLite database path",
          "choices": null
        },
        {
          "name": "graph_type",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "import",
          "help_text": "Graph type to visualize",
          "choices": [
            "import",
            "call"
          ]
        },
        {
          "name": "out_dir",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/raw/",
          "help_text": "Output directory for visualizations",
          "choices": null
        },
        {
          "name": "limit_nodes",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 500,
          "help_text": "Maximum nodes to display",
          "choices": null
        },
        {
          "name": "format",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "dot",
          "help_text": "Output format",
          "choices": [
            "dot",
            "svg",
            "png",
            "json"
          ]
        },
        {
          "name": "view",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "full",
          "help_text": "Visualization view type",
          "choices": [
            "full",
            "cycles",
            "hotspots",
            "layers",
            "impact"
          ]
        },
        {
          "name": "include_analysis",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Include analysis results (cycles, hotspots) in visualization",
          "choices": null
        },
        {
          "name": "title",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Graph title",
          "choices": null
        },
        {
          "name": "top_hotspots",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 10,
          "help_text": "Number of top hotspots to show (for hotspots view)",
          "choices": null
        },
        {
          "name": "impact_target",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Target node for impact analysis (for impact view)",
          "choices": null
        },
        {
          "name": "show_self_loops",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Include self-referential edges",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.1103000142611563,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli graph viz [OPTIONS]\n\n  Visualize graphs with rich visual encoding (Graphviz).\n\n  Creates visually intelligent graphs with multiple view modes:\n\n  VIEW MODES: - full: Complete graph with all nodes and edges - cycles: Only\n  nodes/edges involved in dependency cycles - hotspots: Top N most connected\n  nodes with neighbors - layers: Architectural layers as subgraphs - impact:\n  Highlight impact radius of changes\n\n  VISUAL ENCODING: - Node Color: Programming language (Python=blue, JS=yellow,\n  TS=blue) - Node Size: Importance/connectivity (larger = more dependencies) -\n  Edge Color: Red for cycles, gray for normal - Border Width: Code churn\n  (thicker = more changes) - Node Shape: box=module, ellipse=function,\n  diamond=class\n\n  Examples:     # Basic visualization     aud graph viz          # Show only\n  dependency cycles     aud graph viz --view cycles --include-analysis\n  # Top 5 hotspots with connections     aud graph viz --view hotspots --top-\n  hotspots 5          # Architec",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.487700006691739
    },
    {
      "command": "aud graphql build",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory to analyze",
          "choices": null
        },
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/repo_index.db",
          "help_text": "Repository index database",
          "choices": null
        },
        {
          "name": "verbose",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Verbose output",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.9179999760817736,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli graphql build [OPTIONS]\n\n  Build GraphQL resolver mappings and execution graph.\n\n  Correlates GraphQL SDL schemas with resolver implementations: 1. Load\n  graphql_types and graphql_fields from SDL extraction 2. Load symbols table\n  (all function definitions) 3. Match resolvers to fields via naming conventions\n  + decorators 4. Create graphql_resolver_mappings entries 5. Build execution\n  graph edges (field \u2192 resolver \u2192 downstream)\n\n  Examples:   aud graphql build                    # Default database   aud\n  graphql build --verbose          # Show correlation details   aud graphql\n  build --db custom.db     # Custom database path\n\n  Correlation Strategies:   - Graphene: resolve_<field> methods in ObjectType\n  classes   - Ariadne: @query.field(\"name\") decorator \u2192 function mapping   -\n  Strawberry: @strawberry.field on class methods   - Apollo: resolvers object\n  mapping (Query.field \u2192 function)   - NestJS: @Query()/@Mutation() decorators\n  with field names   - TypeGraphQL: @R",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.3068000262137502
    },
    {
      "command": "aud graphql query",
      "is_group": false,
      "params": [
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/repo_index.db",
          "help_text": "Repository index database",
          "choices": null
        },
        {
          "name": "type_name",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Query specific GraphQL type",
          "choices": null
        },
        {
          "name": "field_name",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Query specific field",
          "choices": null
        },
        {
          "name": "show_resolvers",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show resolver mappings",
          "choices": null
        },
        {
          "name": "show_args",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show field arguments",
          "choices": null
        },
        {
          "name": "output_json",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Output as JSON",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.7712000224273652,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli graphql query [OPTIONS]\n\n  Query GraphQL schema metadata and resolver mappings.\n\n  Examples:   aud graphql query --type Query   aud graphql query --field user\n  --show-resolvers   aud graphql query --type Mutation --show-args   aud graphql\n  query --json > schema.json\n\nOptions:\n  --db TEXT         Repository index database\n  --type TEXT       Query specific GraphQL type\n  --field TEXT      Query specific field\n  --show-resolvers  Show resolver mappings\n  --show-args       Show field arguments\n  --json            Output as JSON\n  --help            Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.133300014771521
    },
    {
      "command": "aud graphql viz",
      "is_group": false,
      "params": [
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/repo_index.db",
          "help_text": "Repository index database",
          "choices": null
        },
        {
          "name": "output",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "graphql_schema.svg",
          "help_text": "Output file path",
          "choices": null
        },
        {
          "name": "format",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "svg",
          "help_text": "Output format (svg, png, dot)",
          "choices": null
        },
        {
          "name": "type_filter",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Filter to specific type",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.3196999789215624,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli graphql viz [OPTIONS]\n\n  Visualize GraphQL schema and execution graph.\n\n  Examples:   aud graphql viz                           # Generate SVG   aud\n  graphql viz --format png -o schema.png   aud graphql viz --type Query\n  # Only Query type\n\nOptions:\n  --db TEXT          Repository index database\n  -o, --output TEXT  Output file path\n  --format TEXT      Output format (svg, png, dot)\n  --type TEXT        Filter to specific type\n  --help             Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.7345999949611723
    },
    {
      "command": "aud impact",
      "is_group": false,
      "params": [
        {
          "name": "file",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Path to the file containing the code to analyze",
          "choices": null
        },
        {
          "name": "line",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Line number of the code to analyze",
          "choices": null
        },
        {
          "name": "symbol",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Symbol name to analyze (alternative to --file --line)",
          "choices": null
        },
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Path to the SQLite database (default: repo_index.db)",
          "choices": null
        },
        {
          "name": "json",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Output results as JSON",
          "choices": null
        },
        {
          "name": "planning_context",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Output in planning-friendly format with risk categories",
          "choices": null
        },
        {
          "name": "max_depth",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 2,
          "help_text": "Maximum depth for transitive dependencies",
          "choices": null
        },
        {
          "name": "verbose",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show detailed dependency information",
          "choices": null
        },
        {
          "name": "trace_to_backend",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Trace frontend API calls to backend endpoints (cross-stack analysis)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.3698000111617148,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli impact [OPTIONS]\n\n  Analyze the blast radius of code changes.\n\n  Maps the complete impact of changing a specific function or class by tracing\n  both upstream (who depends on this) and downstream (what this depends on)\n  dependencies. Essential for understanding risk before refactoring or making\n  changes.\n\n  INPUT OPTIONS (choose one):   --symbol NAME     Query by symbol name\n  (recommended for planning)   --file PATH       Query by file path   --file +\n  --line   Query exact location\n\n  Impact Analysis Reveals:   - Upstream: All code that calls or imports this\n  function/class   - Downstream: All code that this function/class depends on\n  - Transitive: Multi-hop dependencies (A->B->C)   - Cross-stack: Frontend API\n  calls traced to backend endpoints   - Coupling Score: 0-100 metric for\n  entanglement (--planning-context)\n\n  Risk Levels:   Low Impact:    <10 affected files, coupling <30   Medium\n  Impact: 10-30 affected files, coupling 30-70   High Impact:   >30 affected\n  f",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.7056000069715083
    },
    {
      "command": "aud index",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory to analyze",
          "choices": null
        },
        {
          "name": "quiet",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Minimal output",
          "choices": null
        },
        {
          "name": "exclude_self",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Exclude TheAuditor's own files (for self-testing)",
          "choices": null
        },
        {
          "name": "offline",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Skip network operations (deps, docs)",
          "choices": null
        },
        {
          "name": "subprocess_taint",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Run taint analysis as subprocess (slower but isolated)",
          "choices": null
        },
        {
          "name": "wipecache",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Delete all caches before run",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.2583000061567873,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli index [OPTIONS]\n\n  [DEPRECATED] This command now runs 'aud full' for data fidelity.\n\n  \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  \u2550\u2550 DEPRECATION NOTICE: 'aud index' is DEPRECATED \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  The 'aud index' command no longer provides sufficient data fidelity for modern\n  TheAuditor analysis. It now automatically runs the complete 'aud full'\n  pipeline (20 phases) to ensure all analysis commands have proper context.\n\n  WHY THIS CHANGE:   \u2022 Taint analysis requires framework detection (Phase 2)   \u2022\n  Deadcode detection requires workset creation (Phase 3)   \u2022 Graph analysis\n  requires dependency graphs (Phase 9-11)   \u2022 Impact analysis requires call\n  graphs and CFGs   \u2022 Running partial pipelines leads to incomplete/incorrect\n  results\n\n  WHAT HAPPENS NOW:   Running 'aud index' will execute the COMPLETE audit\n  pipeline including:     - Repository indexing (AST parsing",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.6004000208340585
    },
    {
      "command": "aud init",
      "is_group": false,
      "params": [
        {
          "name": "offline",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Skip network operations (deps, docs)",
          "choices": null
        },
        {
          "name": "quiet",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Minimal output",
          "choices": null
        },
        {
          "name": "exclude_self",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Exclude TheAuditor's own files (for self-testing)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.4220000011846423,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli init [OPTIONS]\n\n  [DEPRECATED] This command now runs 'aud full' for data fidelity.\n\n  \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  \u2550\u2550 DEPRECATION NOTICE: 'aud init' is DEPRECATED \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  The 'aud init' command no longer provides sufficient initialization for modern\n  TheAuditor analysis. It now automatically runs the complete 'aud full'\n  pipeline (20 phases) which handles all initialization internally.\n\n  WHY THIS CHANGE:   \u2022 'aud init' originally ran: index \u2192 workset \u2192 deps \u2192 docs\n  (4 steps)   \u2022 Modern analysis requires: frameworks, graphs, CFGs, taint,\n  patterns, etc.   \u2022 Running partial initialization leads to incomplete analysis\n  context   \u2022 'aud full' auto-creates .pf/ directory and handles all setup\n  automatically\n\n  WHAT HAPPENS NOW:   Running 'aud init' will execute 'aud full' which includes:\n  \u2713 Automatic .pf/ directory creation (no separate init n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.7470000020693988
    },
    {
      "command": "aud init-config",
      "is_group": false,
      "params": [
        {
          "name": "pyproject",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "pyproject.toml",
          "help_text": "Path to pyproject.toml",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.7769000076223165,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli init-config [OPTIONS]\n\n  Create or update minimal mypy type-checking configuration in pyproject.toml\n  (idempotent).\n\n  Scaffolds basic mypy configuration required for TheAuditor's lint command to\n  perform Python type checking. Idempotent operation that preserves existing\n  mypy settings while ensuring minimum required configuration exists. Prevents\n  lint failures due to missing mypy config.\n\n  AI ASSISTANT CONTEXT:   Purpose: Bootstrap mypy type-checking configuration\n  Input: Existing pyproject.toml (if present) or create new   Output:\n  pyproject.toml with [tool.mypy] section   Prerequisites: None (creates from\n  scratch if needed)   Integration: Enables 'aud lint' for Python type checking\n  Performance: ~1 second (file I/O only)\n\n  WHY NEEDED:   - TheAuditor's lint command runs mypy for type checking   - mypy\n  requires config file to function properly   - Missing config causes lint\n  failures or incorrect analysis   - Ensures consistent type checking across\n  environm",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.0879999899771065
    },
    {
      "command": "aud init-js",
      "is_group": false,
      "params": [
        {
          "name": "path",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "package.json",
          "help_text": "Path to package.json",
          "choices": null
        },
        {
          "name": "add_hooks",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Add TheAuditor hooks to npm scripts",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.4862999960314482,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli init-js [OPTIONS]\n\n  Create or merge minimal JavaScript/TypeScript project configuration with\n  linting and type-checking setup.\n\n  Scaffolds or updates package.json with ESLint, TypeScript, and Prettier\n  configurations optimized for static analysis. Idempotent operation that merges\n  with existing configuration, never overwrites. Optionally adds TheAuditor npm\n  script hooks for pre-commit validation workflows.\n\n  AI ASSISTANT CONTEXT:   Purpose: Bootstrap JavaScript/TypeScript projects with\n  analysis tooling   Input: Existing package.json (if present) or create new\n  Output: package.json with devDependencies and scripts for lint/typecheck\n  Prerequisites: None (creates from scratch if needed)   Integration: Enables\n  'aud lint' for JavaScript/TypeScript projects   Performance: ~1-2 seconds\n  (file I/O only, no npm install)\n\n  WHAT IT CREATES:   DevDependencies (with PIN_ME placeholders):     - eslint:\n  JavaScript linter     - @typescript-eslint/parser: TypeScript parser",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.8717999919317663
    },
    {
      "command": "aud insights",
      "is_group": false,
      "params": [
        {
          "name": "mode",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "all",
          "help_text": "Which insights modules to run",
          "choices": [
            "ml",
            "graph",
            "taint",
            "impact",
            "all"
          ]
        },
        {
          "name": "ml_train",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Train ML models before generating suggestions",
          "choices": null
        },
        {
          "name": "topk",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 10,
          "help_text": "Top K files for ML suggestions",
          "choices": null
        },
        {
          "name": "output_dir",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/insights",
          "help_text": "Directory for insights output",
          "choices": null
        },
        {
          "name": "print_summary",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Print summary to console",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.5500999870710075,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli insights [OPTIONS]\n\n  Add interpretive scoring and predictions to raw audit facts.\n\n  The Insights system is TheAuditor's optional interpretation layer that sits ON\n  TOP of factual data. While core modules report facts (\"XSS found at line 42\"),\n  insights add interpretation (\"This is CRITICAL severity\").\n\n  CRITICAL UNDERSTANDING - Two-Layer Architecture:   1. Truth Couriers (Core):\n  Report facts without judgment      - \"Data flows from req.body to res.send\"\n  - \"Function complexity is 47\"      - \"17 circular dependencies detected\"\n\n    2. Insights (Optional): Add scoring and interpretation      - \"This is HIGH\n    severity XSS\"      - \"Health score: 35/100 - Needs refactoring\"      - \"Risk\n    prediction: 87% chance of vulnerabilities\"\n\n  Available Insights Modules:\n\n    ML (Machine Learning) - Requires pip install -e \".[ml]\"     - Trains on\n    historical patterns in your codebase     - Predicts which files likely\n    contain vulnerabilities     - Identifies root cause p",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.9452000269666314
    },
    {
      "command": "aud learn",
      "is_group": false,
      "params": [
        {
          "name": "db_path",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/repo_index.db",
          "help_text": "Database path",
          "choices": null
        },
        {
          "name": "manifest",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/manifest.json",
          "help_text": "Manifest file path",
          "choices": null
        },
        {
          "name": "enable_git",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Enable git churn features",
          "choices": null
        },
        {
          "name": "model_dir",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/ml",
          "help_text": "Model output directory",
          "choices": null
        },
        {
          "name": "window",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 50,
          "help_text": "Journal window size",
          "choices": null
        },
        {
          "name": "seed",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 13,
          "help_text": "Random seed",
          "choices": null
        },
        {
          "name": "feedback",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Path to human feedback JSON file",
          "choices": null
        },
        {
          "name": "train_on",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "full",
          "help_text": "Type of historical runs to train on",
          "choices": [
            "full",
            "diff",
            "all"
          ]
        },
        {
          "name": "session_dir",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Path to Claude Code session logs (Tier 5 agent behavior features)",
          "choices": null
        },
        {
          "name": "session_analysis",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show agent behavior analysis from session logs",
          "choices": null
        },
        {
          "name": "print_stats",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Print training statistics",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 2.546000003349036,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli learn [OPTIONS]\n\n  Train machine learning models from historical audit data to predict file risk\n  and root causes.\n\n  Learns patterns from past audit runs stored in .pf/history/ to build\n  predictive models that identify risky files and likely root causes for future\n  changes. Uses supervised learning on features extracted from code structure,\n  git history, and previous findings to enable proactive risk assessment before\n  code review.\n\n  AI ASSISTANT CONTEXT:   Purpose: Train ML models to predict file risk and root\n  cause likelihood   Input: .pf/history/ (historical audit runs),\n  .pf/repo_index.db (code features)   Output: .pf/ml/ (trained models: risk\n  predictor, root cause classifier)   Prerequisites: aud full (multiple\n  historical runs for training data)   Integration: Models used by 'aud suggest'\n  for prioritized analysis   Performance: ~10-30 seconds (scales with history\n  size + feature count)\n\n  WHAT IT LEARNS:   Risk Prediction (Regression Model):     - Which",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 2.978500007884577
    },
    {
      "command": "aud learn-feedback",
      "is_group": false,
      "params": [
        {
          "name": "feedback_file",
          "param_type": "Option",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Path to feedback JSON file",
          "choices": null
        },
        {
          "name": "db_path",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/repo_index.db",
          "help_text": "Database path",
          "choices": null
        },
        {
          "name": "manifest",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/manifest.json",
          "help_text": "Manifest file path",
          "choices": null
        },
        {
          "name": "model_dir",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/ml",
          "help_text": "Model output directory",
          "choices": null
        },
        {
          "name": "train_on",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "full",
          "help_text": "Type of historical runs to train on",
          "choices": [
            "full",
            "diff",
            "all"
          ]
        },
        {
          "name": "print_stats",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Print training statistics",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 2.489199978299439,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli learn-feedback [OPTIONS]\n\n  Re-train ML models with human corrections to improve prediction accuracy via\n  supervised learning.\n\n  Human-in-the-loop machine learning workflow that incorporates expert feedback\n  to correct model predictions. Accepts a JSON file with manual risk/root-cause\n  labels for files that were incorrectly predicted, then re-trains models using\n  this ground truth to reduce future errors. This is the primary mechanism for\n  improving model accuracy beyond cold-start.\n\n  AI ASSISTANT CONTEXT:   Purpose: Improve ML model accuracy via human feedback\n  (supervised correction)   Input: feedback.json (human labels), .pf/history/\n  (training data), .pf/repo_index.db   Output: .pf/ml/ (re-trained models with\n  improved accuracy)   Prerequisites: aud learn (initial models), feedback.json\n  (human corrections)   Integration: Refines models used by 'aud suggest' for\n  better prioritization   Performance: ~15-45 seconds (full re-training with\n  feedback incorporate",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 2.850200020475313
    },
    {
      "command": "aud lint",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory",
          "choices": null
        },
        {
          "name": "workset",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Use workset mode (lint only files in .pf/workset.json)",
          "choices": null
        },
        {
          "name": "workset_path",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Custom workset path (rarely needed)",
          "choices": null
        },
        {
          "name": "manifest",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Manifest file path",
          "choices": null
        },
        {
          "name": "timeout",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Timeout in seconds for each linter",
          "choices": null
        },
        {
          "name": "print_plan",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Print lint plan without executing",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.9557999728713185,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli lint [OPTIONS]\n\n  Run code quality checks with industry-standard linters.\n\n  Automatically detects and runs available linters in your project, normalizing\n  all output into a unified format for analysis. Supports both full codebase and\n  targeted workset analysis.\n\n  Supported Linters (Auto-Detected):   Python:     - ruff       # Fast,\n  comprehensive Python linter     - mypy       # Static type checker     - black\n  # Code formatter (check mode)     - pylint     # Classic Python linter     -\n  bandit     # Security-focused linter\n\n    JavaScript/TypeScript:     - eslint     # Pluggable JS/TS linter     -\n    prettier   # Code formatter (check mode)     - tsc        # TypeScript\n    compiler (type checking)\n\n    Go:     - golangci-lint  # Meta-linter for Go     - go vet         # Go\n    static analyzer\n\n    Docker:     - hadolint   # Dockerfile linter\n\n  Examples:   aud lint                        # Lint entire codebase   aud lint\n  --workset              # Lint only changed",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.2741000100504607
    },
    {
      "command": "aud manual",
      "is_group": false,
      "params": [
        {
          "name": "concept",
          "param_type": "Argument",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "list_concepts",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "List all available concepts",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.348699996015057,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli manual [OPTIONS] [CONCEPT]\n\n  Interactive documentation for TheAuditor concepts, terminology, and security\n  analysis techniques.\n\n  Built-in reference system that explains security concepts, analysis\n  methodologies, and tool-specific terminology through detailed, example-rich\n  explanations optimized for learning. Covers 9 core topics from taint analysis\n  to pipeline architecture, each with practical examples and related commands.\n\n  AI ASSISTANT CONTEXT:   Purpose: Provide interactive documentation for\n  TheAuditor concepts   Input: Concept name (taint, workset, fce, cfg, etc.)\n  Output: Terminal-formatted explanation with examples   Prerequisites: None\n  (standalone documentation)   Integration: Referenced throughout other command\n  help texts   Performance: Instant (no I/O, pure string formatting)\n\n  AVAILABLE CONCEPTS (9 topics):   taint:     - Data flow tracking from\n  untrusted sources to dangerous sinks     - Detects SQL injection, XSS, command\n  injection     - Ex",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.6722999862395227
    },
    {
      "command": "aud metadata analyze",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory",
          "choices": null
        },
        {
          "name": "days",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 90,
          "help_text": "Number of days for churn analysis",
          "choices": null
        },
        {
          "name": "coverage_file",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Path to coverage file (optional)",
          "choices": null
        },
        {
          "name": "skip_churn",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Skip churn analysis",
          "choices": null
        },
        {
          "name": "skip_coverage",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Skip coverage analysis",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.6580000044777989,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli metadata analyze [OPTIONS]\n\n  Run both churn and coverage analysis (convenience command).\n\n  This combines both metadata collection steps into a single command, useful for\n  pipeline integration.\n\n  Examples:     # Run both analyses     aud metadata analyze          # Run with\n  custom coverage file     aud metadata analyze --coverage-file coverage.json\n  # Run churn only     aud metadata analyze --skip-coverage\n\nOptions:\n  --root TEXT           Root directory\n  --days INTEGER        Number of days for churn analysis\n  --coverage-file TEXT  Path to coverage file (optional)\n  --skip-churn          Skip churn analysis\n  --skip-coverage       Skip coverage analysis\n  --help                Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.9950999810826033
    },
    {
      "command": "aud metadata churn",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory to analyze",
          "choices": null
        },
        {
          "name": "days",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 90,
          "help_text": "Number of days to analyze",
          "choices": null
        },
        {
          "name": "output",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/raw/churn_analysis.json",
          "help_text": "Output JSON path",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.6606000242754817,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli metadata churn [OPTIONS]\n\n  Analyze git commit history for code churn metrics.\n\n  Collects pure facts about file volatility: - Number of commits per file in the\n  specified time range - Number of unique authors per file - Days since last\n  modification\n\n  This data provides the temporal dimension for FCE correlation.\n\n  Examples:     # Analyze last 90 days (default)     aud metadata churn\n  # Analyze last 30 days     aud metadata churn --days 30          # Custom\n  output location     aud metadata churn --output analysis/churn.json\n\nOptions:\n  --root TEXT     Root directory to analyze\n  --days INTEGER  Number of days to analyze\n  --output TEXT   Output JSON path\n  --help          Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.9707999997772276
    },
    {
      "command": "aud metadata coverage",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory",
          "choices": null
        },
        {
          "name": "coverage_file",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Path to coverage file (auto-detects if not specified)",
          "choices": null
        },
        {
          "name": "output",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/raw/coverage_analysis.json",
          "help_text": "Output JSON path",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.6618000043090433,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli metadata coverage [OPTIONS]\n\n  Parse test coverage reports for quality metrics.\n\n  Supports: - Python: coverage.json from coverage.py - Node.js: coverage-\n  final.json from Istanbul/nyc\n\n  Collects pure facts about test coverage: - Line coverage percentage per file -\n  Number of executed vs missing lines - List of uncovered line numbers\n\n  This data provides the quality dimension for FCE correlation.\n\n  Examples:     # Auto-detect coverage file     aud metadata coverage          #\n  Specify Python coverage file     aud metadata coverage --coverage-file\n  htmlcov/coverage.json          # Specify Node.js coverage file     aud\n  metadata coverage --coverage-file coverage/coverage-final.json\n\nOptions:\n  --root TEXT           Root directory\n  --coverage-file TEXT  Path to coverage file (auto-detects if not specified)\n  --output TEXT         Output JSON path\n  --help                Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.974599999608472
    },
    {
      "command": "aud planning add-job",
      "is_group": false,
      "params": [
        {
          "name": "plan_id",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "task_number",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "description",
          "param_type": "Option",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Job description (checkbox item)",
          "choices": null
        },
        {
          "name": "is_audit",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Mark this job as an audit job",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.6840999994892627,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli planning add-job [OPTIONS] PLAN_ID TASK_NUMBER\n\n  Add a job (checkbox item) to a task (hierarchical task breakdown).\n\n  Jobs are atomic checkbox actions within a task. Audit jobs verify work\n  completion.\n\n  Example:     aud planning add-job 1 1 --description \"Execute aud blueprint\n  --structure\"     aud planning add-job 1 1 --description \"Verify blueprint ran\n  successfully\" --is-audit\n\nOptions:\n  --description TEXT  Job description (checkbox item)  [required]\n  --is-audit          Mark this job as an audit job\n  --help              Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.9972999978344887
    },
    {
      "command": "aud planning add-phase",
      "is_group": false,
      "params": [
        {
          "name": "plan_id",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "phase_number",
          "param_type": "Option",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Phase number",
          "choices": null
        },
        {
          "name": "title",
          "param_type": "Option",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Phase title",
          "choices": null
        },
        {
          "name": "description",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "",
          "help_text": "Phase description",
          "choices": null
        },
        {
          "name": "success_criteria",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "What completion looks like for this phase (criteria)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.9356999944429845,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli planning add-phase [OPTIONS] PLAN_ID\n\n  Add a phase to a plan (hierarchical planning structure).\n\n  Phases group related tasks and explicitly state success criteria.\n\n  Example:     aud planning add-phase 1 --phase-number 1 --title \"Load Context\"\n  \\         --success-criteria \"Blueprint analysis complete. Precedents\n  extracted from database.\"\n\nOptions:\n  --phase-number INTEGER   Phase number  [required]\n  --title TEXT             Phase title  [required]\n  --description TEXT       Phase description\n  --success-criteria TEXT  What completion looks like for this phase (criteria)\n  --help                   Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.447799993911758
    },
    {
      "command": "aud planning add-task",
      "is_group": false,
      "params": [
        {
          "name": "plan_id",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "title",
          "param_type": "Option",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Task title",
          "choices": null
        },
        {
          "name": "description",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "",
          "help_text": "Task description",
          "choices": null
        },
        {
          "name": "spec",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "YAML verification spec file",
          "choices": null
        },
        {
          "name": "assigned_to",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Assignee name",
          "choices": null
        },
        {
          "name": "phase",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Phase number to associate this task with (optional)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.8049000171013176,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli planning add-task [OPTIONS] PLAN_ID\n\n  Add a task to a plan with optional verification spec.\n\n  Can optionally associate task with a phase (hierarchical planning).\n\n  Example:     aud planning add-task 1 --title \"Migrate auth\" --spec\n  auth_spec.yaml     aud planning add-task 1 --title \"Query patterns\" --phase 2\n\nOptions:\n  --title TEXT        Task title  [required]\n  --description TEXT  Task description\n  --spec PATH         YAML verification spec file\n  --assigned-to TEXT  Assignee name\n  --phase INTEGER     Phase number to associate this task with (optional)\n  --help              Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.1360000062268227
    },
    {
      "command": "aud planning archive",
      "is_group": false,
      "params": [
        {
          "name": "plan_id",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "notes",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Archive notes",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.5905999860260636,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli planning archive [OPTIONS] PLAN_ID\n\n  Archive completed plan with final snapshot.\n\n  Creates a final snapshot of the codebase state and marks the plan as archived.\n  This creates an immutable audit trail.\n\n  Example:     aud planning archive 1 --notes \"Migration completed successfully\"\n\nOptions:\n  --notes TEXT  Archive notes\n  --help        Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.8930999902077019
    },
    {
      "command": "aud planning checkpoint",
      "is_group": false,
      "params": [
        {
          "name": "plan_id",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "task_number",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "name",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Checkpoint name (optional, auto-generates if not provided)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.610699993558228,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli planning checkpoint [OPTIONS] PLAN_ID TASK_NUMBER\n\n  Create incremental snapshot after editing code.\n\n  Use this command after making changes to track incremental edits. Each\n  checkpoint is numbered sequentially (edit_1, edit_2, etc.).\n\n  Example:     # Make code changes     aud planning checkpoint 1 1 --name \"add-\n  imports\"     # Make more changes     aud planning checkpoint 1 1 --name\n  \"update-function\"     # View all checkpoints     aud planning show-diff 1 1\n\nOptions:\n  --name TEXT  Checkpoint name (optional, auto-generates if not provided)\n  --help       Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.912799994694069
    },
    {
      "command": "aud planning init",
      "is_group": false,
      "params": [
        {
          "name": "name",
          "param_type": "Option",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Plan name",
          "choices": null
        },
        {
          "name": "description",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "",
          "help_text": "Plan description",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.6706999847665429,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli planning init [OPTIONS]\n\n  Create a new implementation plan.\n\n  Example:     aud planning init --name \"Auth Migration\" --description \"Migrate\n  to OAuth2\"\n\nOptions:\n  --name TEXT         Plan name  [required]\n  --description TEXT  Plan description\n  --help              Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.9892999951262027
    },
    {
      "command": "aud planning list",
      "is_group": false,
      "params": [
        {
          "name": "status",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Filter by status (active/completed/archived)",
          "choices": null
        },
        {
          "name": "format",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "table",
          "help_text": "Output format",
          "choices": [
            "table",
            "json"
          ]
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.6680999940726906,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli planning list [OPTIONS]\n\n  List all plans in the database.\n\n  Example:     aud planning list     aud planning list --status active     aud\n  planning list --format json\n\nOptions:\n  --status TEXT          Filter by status (active/completed/archived)\n  --format [table|json]  Output format\n  --help                 Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.0442000057082623
    },
    {
      "command": "aud planning rewind",
      "is_group": false,
      "params": [
        {
          "name": "plan_id",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "task_number",
          "param_type": "Argument",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "checkpoint",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Specific checkpoint name to rewind to",
          "choices": null
        },
        {
          "name": "to_sequence",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Rewind to specific sequence number (e.g., --to 2 for edit_2)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.1199000000488013,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli planning rewind [OPTIONS] PLAN_ID [TASK_NUMBER]\n\n  Show rollback instructions for a plan or task.\n\n  Displays git commands to revert to a previous snapshot state. Does NOT execute\n  the commands - only shows them for manual review.\n\n  For task-level granular rewind, use --to with sequence number.\n\n  Example:     aud planning rewind 1                    # List all plan\n  snapshots     aud planning rewind 1 --checkpoint \"pre-migration\"  # Plan-level\n  rewind     aud planning rewind 1 1 --to 2           # Task-level: rewind to\n  edit_2     aud planning rewind 1 1                  # List all task\n  checkpoints\n\nOptions:\n  --checkpoint TEXT  Specific checkpoint name to rewind to\n  --to INTEGER       Rewind to specific sequence number (e.g., --to 2 for\n                     edit_2)\n  --help             Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.4486000000033528
    },
    {
      "command": "aud planning setup-agents",
      "is_group": false,
      "params": [
        {
          "name": "target",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "AGENTS.md",
          "help_text": "Target file for injection",
          "choices": [
            "AGENTS.md",
            "CLAUDE.md",
            "both"
          ]
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.6458999996539205,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli planning setup-agents [OPTIONS]\n\n  Inject TheAuditor agent trigger block into project documentation.\n\n  Adds agent trigger instructions to AGENTS.md or CLAUDE.md that tell AI\n  assistants when to load specialized agent workflows for planning, refactoring,\n  security analysis, and dataflow tracing.\n\n  The trigger block references agent files in\n  .auditor_venv/.theauditor_tools/agents/ which are copied during venv setup\n  (via venv_install.py).\n\n  Example:     aud planning setup-agents                      # Inject into\n  AGENTS.md     aud planning setup-agents --target CLAUDE.md   # Inject into\n  CLAUDE.md     aud planning setup-agents --target both        # Inject into\n  both files\n\nOptions:\n  --target [AGENTS.md|CLAUDE.md|both]\n                                  Target file for injection\n  --help                          Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.9704999974928796
    },
    {
      "command": "aud planning show",
      "is_group": false,
      "params": [
        {
          "name": "plan_id",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "tasks",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": true,
          "help_text": "Show task list (default: True)",
          "choices": null
        },
        {
          "name": "verbose",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show detailed information",
          "choices": null
        },
        {
          "name": "format",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "phases",
          "help_text": "Display format (default: phases)",
          "choices": [
            "flat",
            "phases"
          ]
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.6550999823957682,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli planning show [OPTIONS] PLAN_ID\n\n  Display plan details and task status.\n\n  By default shows full hierarchy (phases \u2192 tasks \u2192 jobs).\n\n  Example:     aud planning show 1                           # Full hierarchy\n  (default)     aud planning show 1 --format flat             # Flat task list\n  aud planning show 1 --no-tasks                # Basic info only\n\nOptions:\n  --tasks / --no-tasks    Show task list (default: True)\n  -v, --verbose           Show detailed information\n  --format [flat|phases]  Display format (default: phases)\n  --help                  Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.9836000099312514
    },
    {
      "command": "aud planning show-diff",
      "is_group": false,
      "params": [
        {
          "name": "plan_id",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "task_number",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "sequence",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Show specific checkpoint by sequence number",
          "choices": null
        },
        {
          "name": "file",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Show diff for specific file only",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.6187999970279634,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli planning show-diff [OPTIONS] PLAN_ID TASK_NUMBER\n\n  View stored diffs for a task.\n\n  Shows incremental checkpoints and diffs for the specified task. Use --sequence\n  to view a specific checkpoint's diff.\n\n  Example:     aud planning show-diff 1 1              # List all checkpoints\n  aud planning show-diff 1 1 --sequence 2 # Show edit_2 diff     aud planning\n  show-diff 1 1 --file auth.py  # Show diffs for auth.py only\n\nOptions:\n  --sequence INTEGER  Show specific checkpoint by sequence number\n  --file TEXT         Show diff for specific file only\n  --help              Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.9321999968960881
    },
    {
      "command": "aud planning update-task",
      "is_group": false,
      "params": [
        {
          "name": "plan_id",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "task_number",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "status",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "New status",
          "choices": [
            "pending",
            "in_progress",
            "completed",
            "blocked"
          ]
        },
        {
          "name": "assigned_to",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Reassign task",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.6253999890759587,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli planning update-task [OPTIONS] PLAN_ID TASK_NUMBER\n\n  Update task status or assignment.\n\n  Example:     aud planning update-task 1 1 --status completed     aud planning\n  update-task 1 2 --assigned-to \"Alice\"\n\nOptions:\n  --status [pending|in_progress|completed|blocked]\n                                  New status\n  --assigned-to TEXT              Reassign task\n  --help                          Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.9486000053584576
    },
    {
      "command": "aud planning validate",
      "is_group": false,
      "params": [
        {
          "name": "plan_id",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "session_id",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Specific session ID to validate against (defaults to latest)",
          "choices": null
        },
        {
          "name": "format",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "text",
          "help_text": "Output format",
          "choices": [
            "text",
            "json"
          ]
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.7329999934881926,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli planning validate [OPTIONS] PLAN_ID\n\n  Validate plan execution against session logs.\n\n  Compares planned files vs actually modified files from session history. Checks\n  workflow compliance and blind edit rate.\n\n  Example:     aud planning validate 1                    # Validate latest\n  session     aud planning validate 1 --session-id abc123  # Validate specific\n  session     aud planning validate 1 --format json     # JSON output\n\nOptions:\n  --session-id TEXT     Specific session ID to validate against (defaults to\n                        latest)\n  --format [text|json]  Output format\n  --help                Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.0937000042758882
    },
    {
      "command": "aud planning verify-task",
      "is_group": false,
      "params": [
        {
          "name": "plan_id",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "task_number",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "verbose",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show detailed violations",
          "choices": null
        },
        {
          "name": "auto_update",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Auto-update task status based on result",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.7348000071942806,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli planning verify-task [OPTIONS] PLAN_ID TASK_NUMBER\n\n  Verify task completion against its spec.\n\n  Runs verification spec against current codebase and reports violations.\n  Optionally updates task status based on verification result.\n\n  Example:     aud planning verify-task 1 1 --verbose     aud planning verify-\n  task 1 1 --auto-update\n\nOptions:\n  -v, --verbose  Show detailed violations\n  --auto-update  Auto-update task status based on result\n  --help         Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.1138000118080527
    },
    {
      "command": "aud query",
      "is_group": false,
      "params": [
        {
          "name": "symbol",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Query symbol by exact name (functions, classes, variables)",
          "choices": null
        },
        {
          "name": "file",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Query file by path (partial match supported)",
          "choices": null
        },
        {
          "name": "api",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Query API endpoint by route pattern (supports wildcards)",
          "choices": null
        },
        {
          "name": "component",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Query React/Vue component by name",
          "choices": null
        },
        {
          "name": "variable",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Query variable by name (for data flow tracing)",
          "choices": null
        },
        {
          "name": "pattern",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Search symbols by pattern (supports % wildcards like 'auth%')",
          "choices": null
        },
        {
          "name": "category",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Search by security category (jwt, oauth, password, sql, xss, auth)",
          "choices": null
        },
        {
          "name": "search",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Cross-table exploratory search (finds term across all tables)",
          "choices": null
        },
        {
          "name": "list_mode",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "List all symbols in file (symbols, functions, classes, imports, all)",
          "choices": null
        },
        {
          "name": "list_symbols",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Discovery mode: list symbols matching filter pattern",
          "choices": null
        },
        {
          "name": "symbol_filter",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Symbol name pattern for --list-symbols (e.g., '*Controller*', '*auth*')",
          "choices": null
        },
        {
          "name": "path_filter",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "File path pattern for --list-symbols (e.g., 'src/api/*', 'services/')",
          "choices": null
        },
        {
          "name": "show_callers",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show who calls this symbol (control flow incoming)",
          "choices": null
        },
        {
          "name": "show_callees",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show what this symbol calls (control flow outgoing)",
          "choices": null
        },
        {
          "name": "show_dependencies",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show what this file imports (outgoing dependencies)",
          "choices": null
        },
        {
          "name": "show_dependents",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show who imports this file (incoming dependencies)",
          "choices": null
        },
        {
          "name": "show_incoming",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show who CALLS symbols in this file (incoming calls)",
          "choices": null
        },
        {
          "name": "show_tree",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show component hierarchy tree (parent-child relationships)",
          "choices": null
        },
        {
          "name": "show_hooks",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show React hooks used by component",
          "choices": null
        },
        {
          "name": "show_data_deps",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show data dependencies (what vars function reads/writes) - DFG",
          "choices": null
        },
        {
          "name": "show_flow",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show variable flow through assignments (def-use chains) - DFG",
          "choices": null
        },
        {
          "name": "show_taint_flow",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show cross-function taint flow (returns -> assignments) - DFG",
          "choices": null
        },
        {
          "name": "show_api_coverage",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show API security coverage (auth controls per endpoint)",
          "choices": null
        },
        {
          "name": "type_filter",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Filter pattern search by symbol type (function, class, variable)",
          "choices": null
        },
        {
          "name": "include_tables",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Comma-separated tables for cross-table search (e.g., 'symbols,findings')",
          "choices": null
        },
        {
          "name": "depth",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 1,
          "help_text": "Traversal depth for transitive queries (1-5, default=1)",
          "choices": null
        },
        {
          "name": "output_format",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "text",
          "help_text": "Output format: text (human), json (AI), tree (visual)",
          "choices": [
            "text",
            "json",
            "tree"
          ]
        },
        {
          "name": "save",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Save output to file (auto-creates parent dirs)",
          "choices": null
        },
        {
          "name": "show_code",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Include source code snippets for callers/callees (default: no)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.6710000054445118,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli query [OPTIONS]\n\n  Query code relationships from indexed database.\n\n  Direct SQL queries over TheAuditor's indexed code relationships. Returns exact\n  file:line locations. No file reading, no inference.\n\n  PREREQUISITE: Run 'aud full' first to build the index.\n\n  QUERY TARGETS (pick one):\n    --symbol NAME       Function/class lookup, combine with --show-callers\n    --file PATH         File dependencies, combine with --show-dependents\n    --api ROUTE         API endpoint handler lookup\n    --component NAME    React/Vue component tree\n    --pattern PATTERN   SQL LIKE search (use % wildcard)\n    --list-symbols      Discovery mode with --filter and --path\n\n  ACTION FLAGS (what to show):\n    --show-callers      Who calls this symbol?\n    --show-callees      What does this symbol call?\n    --show-dependencies What does this file import?\n    --show-dependents   Who imports this file?\n    --show-data-deps    What variables does function read/write?\n    --show-flow         Trace var",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 2.0724000059999526
    },
    {
      "command": "aud refactor",
      "is_group": false,
      "params": [
        {
          "name": "migration_dir",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "backend/migrations",
          "help_text": "Directory containing database migrations",
          "choices": null
        },
        {
          "name": "migration_limit",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 5,
          "help_text": "Number of recent migrations to analyze (0=all, default=5)",
          "choices": null
        },
        {
          "name": "profile_file",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Refactor profile YAML describing old/new schema expectations",
          "choices": null
        },
        {
          "name": "output",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Output file for detailed report",
          "choices": null
        },
        {
          "name": "in_file_filter",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Only scan files matching this pattern (e.g., 'OrderDetails' or 'src/components')",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.8059999856632203,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli refactor [OPTIONS]\n\n  Detect incomplete refactorings and breaking changes from database schema\n  migrations.\n\n  Analyzes database migration files to identify removed/renamed tables and\n  columns, then queries the codebase for references to those deleted schema\n  elements. Reports code that will break at runtime due to schema-code mismatch\n  - the classic \"forgot to update the queries\" problem that breaks production\n  silently.\n\n  AI ASSISTANT CONTEXT:   Purpose: Detect code-schema mismatches from incomplete\n  refactorings   Input: backend/migrations/ (SQL files), .pf/repo_index.db (code\n  references)   Output: Breaking changes report (code using deleted\n  tables/columns)   Prerequisites: aud index (for code symbol database)\n  Integration: Pre-deployment validation, refactoring safety checks\n  Performance: ~2-5 seconds (migration parsing + database queries)\n\n  WHAT IT DETECTS:   Schema Changes:     - Dropped tables (DROP TABLE users)\n  - Renamed tables (ALTER TABLE users RENA",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 2.218699984950945
    },
    {
      "command": "aud report",
      "is_group": false,
      "params": [
        {
          "name": "manifest",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/manifest.json",
          "help_text": "Manifest file path",
          "choices": null
        },
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/repo_index.db",
          "help_text": "Database path",
          "choices": null
        },
        {
          "name": "workset",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/workset.json",
          "help_text": "Workset file path",
          "choices": null
        },
        {
          "name": "capsules",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/capsules",
          "help_text": "Capsules directory",
          "choices": null
        },
        {
          "name": "run_report",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/run_report.json",
          "help_text": "Run report file path",
          "choices": null
        },
        {
          "name": "journal",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/journal.ndjson",
          "help_text": "Journal file path",
          "choices": null
        },
        {
          "name": "fce",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/fce.json",
          "help_text": "FCE file path",
          "choices": null
        },
        {
          "name": "ast",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/ast_proofs.json",
          "help_text": "AST proofs file path",
          "choices": null
        },
        {
          "name": "ml",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/ml_suggestions.json",
          "help_text": "ML suggestions file path",
          "choices": null
        },
        {
          "name": "patch",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Patch diff file path",
          "choices": null
        },
        {
          "name": "out_dir",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/audit",
          "help_text": "Output directory for audit reports",
          "choices": null
        },
        {
          "name": "max_snippet_lines",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 3,
          "help_text": "Maximum lines per snippet",
          "choices": null
        },
        {
          "name": "max_snippet_chars",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 220,
          "help_text": "Maximum characters per line",
          "choices": null
        },
        {
          "name": "print_stats",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Print summary statistics",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.3869999966118485,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli report [OPTIONS]\n\n  Generate consolidated audit report from analysis artifacts.\n\n  **DEPRECATED**: This command generates .pf/readthis/ chunks which are obsolete\n  as of v1.6.4. Use `aud query` for database queries or read consolidated files\n  in .pf/raw/ directly. See migration guide in README.md.\n\n  This command is kept for backward compatibility only.\n\n  AI ASSISTANT CONTEXT:   Purpose: [DEPRECATED] Consolidate artifacts into\n  chunks (obsolete)   Input: .pf/raw/*.json (all analysis phase outputs)\n  Output: .pf/readthis/*.json (chunked findings <65KB each) [DEPRECATED]\n  Prerequisites: aud full (or individual analysis commands)   Integration:\n  [DEPRECATED] Use `aud query` or read .pf/raw/*.json instead   Performance:\n  ~2-5 seconds (JSON aggregation + chunking)\n\n  Input Sources (Auto-Detected):   - Pattern detection results\n  (.pf/raw/patterns*.json)   - Taint analysis findings (.pf/raw/taint*.json)   -\n  Lint results (.pf/raw/lint.json)   - Dependency analysis (.pf/raw/",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.7875999910756946
    },
    {
      "command": "aud rules",
      "is_group": false,
      "params": [
        {
          "name": "summary",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Generate a summary of all detection capabilities",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.3743000163231045,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli rules [OPTIONS]\n\n  Inspect and summarize TheAuditor's detection rules and patterns.\n\n  Generates a comprehensive inventory of all security rules, vulnerability\n  patterns, and code quality checks built into TheAuditor. Scans YAML pattern\n  files and Python AST rules to create a complete capability report for\n  documentation, compliance, and customization planning.\n\n  AI ASSISTANT CONTEXT:   Purpose: Document TheAuditor's detection capabilities\n  Input: theauditor/patterns/*.yml, theauditor/rules/*.py (pattern definitions)\n  Output: .pf/auditor_capabilities.md (comprehensive report)   Prerequisites:\n  None (reads pattern files, no indexing required)   Integration: Security\n  documentation, compliance reporting, custom pattern development   Performance:\n  ~1-2 seconds (file scanning only)\n\n  WHY USE THIS: - Understand what vulnerabilities TheAuditor can detect -\n  Document your security audit capabilities for compliance - Verify which\n  patterns are active in your analysis - C",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.7644000181462616
    },
    {
      "command": "aud session analyze",
      "is_group": false,
      "params": [
        {
          "name": "session_dir",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Path to session directory (auto-detects if omitted)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.7997000066097826,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli session analyze [OPTIONS]\n\n  Analyze AI agent sessions and store to .pf/ml/session_history.db.\n\n  Auto-detects session directories for: - Claude Code:\n  ~/.claude/projects/<project-name>/ - Codex: ~/.codex/sessions/ (filtered by\n  cwd)\n\n  Runs 3-layer analysis pipeline: 1. Parse session logs (.jsonl files) 2. Score\n  diffs through SAST pipeline 3. Check workflow compliance (planning.md)\n\n  Stores results to persistent .pf/ml/session_history.db for ML training.\n\nOptions:\n  --session-dir TEXT  Path to session directory (auto-detects if omitted)\n  --help              Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.139200001489371
    },
    {
      "command": "aud session inspect",
      "is_group": false,
      "params": [
        {
          "name": "session_file",
          "param_type": "Argument",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": null,
          "choices": null
        },
        {
          "name": "db_path",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".pf/repo_index.db",
          "help_text": "Path to repo_index.db",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.5200000014156103,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli session inspect [OPTIONS] SESSION_FILE\n\n  Inspect a single session file in detail.\n\nOptions:\n  --db-path TEXT  Path to repo_index.db\n  --help          Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.8165999897755682
    },
    {
      "command": "aud session list",
      "is_group": false,
      "params": [
        {
          "name": "project_path",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Project path (defaults to current directory)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.46519999159500003,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli session list [OPTIONS]\n\n  List all sessions for this project.\n\nOptions:\n  --project-path TEXT  Project path (defaults to current directory)\n  --help               Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.7258999976329505
    },
    {
      "command": "aud session report",
      "is_group": false,
      "params": [
        {
          "name": "project_path",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Project path (defaults to current directory)",
          "choices": null
        },
        {
          "name": "db_path",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".pf/repo_index.db",
          "help_text": "Path to repo_index.db",
          "choices": null
        },
        {
          "name": "limit",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 10,
          "help_text": "Limit number of sessions to analyze",
          "choices": null
        },
        {
          "name": "show_findings",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": true,
          "help_text": "Show individual findings",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.48580000293441117,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli session report [OPTIONS]\n\n  Generate detailed report of Claude Code sessions (legacy analyzer).\n\nOptions:\n  --project-path TEXT             Project path (defaults to current directory)\n  --db-path TEXT                  Path to repo_index.db\n  --limit INTEGER                 Limit number of sessions to analyze\n  --show-findings / --no-findings\n                                  Show individual findings\n  --help                          Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.7444999937433749
    },
    {
      "command": "aud setup-ai",
      "is_group": false,
      "params": [
        {
          "name": "target",
          "param_type": "Option",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Target project root (absolute or relative path)",
          "choices": null
        },
        {
          "name": "sync",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Force update (reinstall packages)",
          "choices": null
        },
        {
          "name": "dry_run",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Print plan without executing",
          "choices": null
        },
        {
          "name": "show_versions",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show installed tool versions (reads from cache or runs detection)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.3615000061690807,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli setup-ai [OPTIONS]\n\n  Create isolated analysis environment with offline vulnerability databases and\n  sandboxed tooling.\n\n  One-time setup command that creates a completely sandboxed Python virtual\n  environment with TheAuditor and all analysis tools (ESLint, TypeScript, OSV-\n  Scanner), plus offline vulnerability databases (~500MB) for air-gapped\n  security scanning. Enables zero-dependency analysis and offline vulnerability\n  detection with no external API calls or rate limits.\n\n  AI ASSISTANT CONTEXT:   Purpose: Bootstrap sandboxed analysis environment for\n  offline operation   Input: Target project directory path   Output:\n  .auditor_venv/ (Python venv), .auditor_tools/ (JS tools), vuln databases\n  Prerequisites: Python >=3.11, Node.js (for JavaScript tooling), network\n  (initial download)   Integration: Enables 'aud deps --vuln-scan' and 'aud\n  lint' in isolation   Performance: ~5-10 minutes (one-time setup, downloads\n  ~500MB vulnerability data)\n\n  WHAT IT INSTALLS:   ",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.660000008996576
    },
    {
      "command": "aud setup-claude",
      "is_group": false,
      "params": [
        {
          "name": "target",
          "param_type": "Option",
          "required": true,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Target project root (absolute or relative path)",
          "choices": null
        },
        {
          "name": "sync",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Force update (reinstall packages)",
          "choices": null
        },
        {
          "name": "dry_run",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Print plan without executing",
          "choices": null
        },
        {
          "name": "show_versions",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show installed tool versions (reads from cache or runs detection)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.5302000208757818,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli setup-claude [OPTIONS]\n\n  Deprecated: Use setup-ai instead.\n\nOptions:\n  --target TEXT    Target project root (absolute or relative path)  [required]\n  --sync           Force update (reinstall packages)\n  --dry-run        Print plan without executing\n  --show-versions  Show installed tool versions (reads from cache or runs\n                   detection)\n  --help           Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.7953000022098422
    },
    {
      "command": "aud structure",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory to analyze",
          "choices": null
        },
        {
          "name": "manifest",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/manifest.json",
          "help_text": "Path to manifest.json",
          "choices": null
        },
        {
          "name": "db_path",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/repo_index.db",
          "help_text": "Path to repo_index.db",
          "choices": null
        },
        {
          "name": "output",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/readthis/STRUCTURE.md",
          "help_text": "Output file path",
          "choices": null
        },
        {
          "name": "max_depth",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 4,
          "help_text": "Maximum directory tree depth",
          "choices": null
        },
        {
          "name": "monoliths",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Find files >2150 lines (too large for AI to read)",
          "choices": null
        },
        {
          "name": "threshold",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 2150,
          "help_text": "Line count threshold for --monoliths (default: 2150)",
          "choices": null
        },
        {
          "name": "format",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "text",
          "help_text": "Output format for --monoliths",
          "choices": [
            "text",
            "json"
          ]
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.4856000198051333,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli structure [OPTIONS]\n\n  Generate comprehensive project structure and intelligence report.\n\n  Creates a detailed markdown report optimized for AI assistants to quickly\n  understand your codebase architecture, identify key files, and make informed\n  decisions about where to focus attention.\n\n  Report Sections:   1. Project Overview:      - Total files, lines of code,\n  estimated tokens      - Language distribution with percentages      -\n  Framework detection (Django, React, etc.)\n\n    2. Directory Structure:      - Visual ASCII tree (configurable depth)      -\n    Folder purposes and contents      - Hidden directory indicators\n\n    3. Code Intelligence:      - Top 10 largest files by token count      - Top\n    15 critical files (main, index, app, etc.)      - Entry points and\n    configuration files      - Test file locations\n\n    4. AI Optimization Insights:      - Token usage vs Claude's context window\n    - Files that should be prioritized      - Files that can be safely ig",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.8268999992869794
    },
    {
      "command": "aud suggest",
      "is_group": false,
      "params": [
        {
          "name": "db_path",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/repo_index.db",
          "help_text": "Database path",
          "choices": null
        },
        {
          "name": "manifest",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/manifest.json",
          "help_text": "Manifest file path",
          "choices": null
        },
        {
          "name": "workset",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/workset.json",
          "help_text": "Workset file path",
          "choices": null
        },
        {
          "name": "model_dir",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/ml",
          "help_text": "Model directory",
          "choices": null
        },
        {
          "name": "topk",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 10,
          "help_text": "Top K files to suggest",
          "choices": null
        },
        {
          "name": "out",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/insights/ml_suggestions.json",
          "help_text": "Output file path",
          "choices": null
        },
        {
          "name": "print_plan",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Print suggestions to console",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.6056000022217631,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli suggest [OPTIONS]\n\n  Generate ML-powered priority list of files most likely to contain\n  vulnerabilities.\n\n  Uses trained ML models (from 'aud learn') to predict which files in the\n  current workset are highest risk and most likely to be root causes of issues.\n  Ranks files by predicted risk score to enable prioritized code review and\n  targeted analysis. This is a predictive optimization - analyze high-risk files\n  first for faster issue discovery.\n\n  AI ASSISTANT CONTEXT:   Purpose: Prioritize files for review using ML risk\n  predictions   Input: .pf/ml/ (trained models), .pf/workset.json (files to\n  analyze)   Output: .pf/insights/ml_suggestions.json (ranked file list with\n  scores)   Prerequisites: aud learn (must train models first), aud workset\n  (files to rank)   Integration: Priority list for human reviewers or targeted\n  'aud taint-analyze'   Performance: ~1-5 seconds (inference only, no training)\n\n  WHAT IT PREDICTS:   File Risk Scores (0.0-1.0):     - Probability ",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.9115000031888485
    },
    {
      "command": "aud summary",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory",
          "choices": null
        },
        {
          "name": "raw_dir",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/raw",
          "help_text": "Raw outputs directory",
          "choices": null
        },
        {
          "name": "out",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/raw/audit_summary.json",
          "help_text": "Output path for summary",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 1.2891000078525394,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli summary [OPTIONS]\n\n  Aggregate statistics from all analysis phases into machine-readable executive\n  summary JSON.\n\n  Post-audit reporting command that consolidates findings from all completed\n  analysis phases into a single JSON summary with severity breakdowns, phase\n  completion status, and overall audit health metrics. Designed for CI/CD\n  integration and programmatic consumption (not human reading - use 'aud report'\n  for AI-optimized markdown).\n\n  AI ASSISTANT CONTEXT:   Purpose: Aggregate audit statistics for CI/CD and\n  metrics tracking   Input: .pf/raw/*.json (all analysis phase outputs)\n  Output: .pf/raw/audit_summary.json (consolidated statistics)   Prerequisites:\n  aud full (or multiple analysis commands)   Integration: CI/CD pass/fail gates,\n  monitoring dashboards, metrics   Performance: ~1-2 seconds (JSON aggregation,\n  no analysis)\n\n  WHAT IT AGGREGATES:   Severity Counts:     - CRITICAL findings count     -\n  HIGH findings count     - MEDIUM/LOW findings cou",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.699300017207861
    },
    {
      "command": "aud taint-analyze",
      "is_group": false,
      "params": [
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Path to the SQLite database (default: repo_index.db)",
          "choices": null
        },
        {
          "name": "output",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/raw/taint_analysis.json",
          "help_text": "Output path for analysis results",
          "choices": null
        },
        {
          "name": "max_depth",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 5,
          "help_text": "Maximum depth for taint propagation tracing",
          "choices": null
        },
        {
          "name": "json",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Output raw JSON instead of formatted report",
          "choices": null
        },
        {
          "name": "verbose",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show detailed path information",
          "choices": null
        },
        {
          "name": "severity",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "all",
          "help_text": "Filter results by severity level",
          "choices": [
            "all",
            "critical",
            "high",
            "medium",
            "low"
          ]
        },
        {
          "name": "rules",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": true,
          "help_text": "Enable/disable rule-based detection",
          "choices": null
        },
        {
          "name": "memory",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": true,
          "help_text": "Use in-memory caching for 5-10x performance (enabled by default)",
          "choices": null
        },
        {
          "name": "memory_limit",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Memory limit for cache in MB (auto-detected based on system RAM if not set)",
          "choices": null
        },
        {
          "name": "mode",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "backward",
          "help_text": "Analysis mode: backward (IFDS), forward (entry->exit), complete (all flows)",
          "choices": [
            "backward",
            "forward",
            "complete"
          ]
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 2.7985000051558018,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli taint-analyze [OPTIONS]\n\n  Trace data flow from untrusted sources to dangerous sinks to detect injection\n  vulnerabilities.\n\n  Performs inter-procedural data flow analysis to identify security\n  vulnerabilities where untrusted user input flows into dangerous functions\n  without sanitization. Uses Control Flow Graph (CFG) for path-sensitive\n  analysis and in-memory caching for 5-10x performance boost on large codebases.\n\n  AI ASSISTANT CONTEXT:   Purpose: Detects injection vulnerabilities via taint\n  propagation analysis   Input: .pf/repo_index.db (function calls, assignments,\n  control flow)   Output: .pf/raw/taint_analysis.json (taint paths with\n  severity)   Prerequisites: aud index (populates database with call graph +\n  CFG)   Integration: Core security analysis, runs in 'aud full' pipeline\n  Performance: ~30s-5min depending on codebase size (CFG+memory optimization)\n\n  WHAT IT DETECTS (By Vulnerability Class):   SQL Injection (SQLi):     Sources:\n  request.args, request",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 3.3180000027641654
    },
    {
      "command": "aud terraform analyze",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory to analyze",
          "choices": null
        },
        {
          "name": "severity",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "all",
          "help_text": "Minimum severity to report",
          "choices": [
            "critical",
            "high",
            "medium",
            "low",
            "all"
          ]
        },
        {
          "name": "categories",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Specific categories to check (e.g., public_exposure, iam_wildcard)",
          "choices": null
        },
        {
          "name": "output",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/raw/terraform_findings.json",
          "help_text": "Output JSON path",
          "choices": null
        },
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/repo_index.db",
          "help_text": "Database path",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.904799991985783,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli terraform analyze [OPTIONS]\n\n  Analyze Terraform for security issues.\n\n  Detects infrastructure security issues including: - Public exposure (S3\n  buckets, databases, security groups) - Overly permissive IAM policies\n  (wildcards) - Hardcoded secrets in resource configurations - Missing\n  encryption for sensitive resources - Unencrypted network traffic\n\n  Examples:   aud terraform analyze                      # Full analysis   aud\n  terraform analyze --severity critical  # Critical issues only   aud terraform\n  analyze --categories public_exposure\n\n  Prerequisites:   - Run 'aud index' first to extract Terraform resources   -\n  Optionally run 'aud terraform provision' for graph-based analysis\n\n  Output:   .pf/raw/terraform_findings.json    # JSON findings export\n  terraform_findings table           # Database findings for FCE\n\nOptions:\n  --root TEXT                     Root directory to analyze\n  --severity [critical|high|medium|low|all]\n                                  Mini",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.273000001674518
    },
    {
      "command": "aud terraform provision",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory to analyze",
          "choices": null
        },
        {
          "name": "workset",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Build graph for workset files only",
          "choices": null
        },
        {
          "name": "output",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/raw/terraform_graph.json",
          "help_text": "Output JSON path",
          "choices": null
        },
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/repo_index.db",
          "help_text": "Source database path",
          "choices": null
        },
        {
          "name": "graphs_db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/graphs.db",
          "help_text": "Graph database path",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.9444000024814159,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli terraform provision [OPTIONS]\n\n  Build Terraform provisioning flow graph.\n\n  Constructs a data flow graph showing how variables, resources, and outputs\n  connect through dependencies and interpolations.\n\n  The graph enables: - Tracing sensitive data (e.g., passwords) through\n  infrastructure - Understanding resource dependency chains - Calculating blast\n  radius of changes - Identifying public exposure paths\n\n  Examples:   aud terraform provision                    # Build full graph\n  aud terraform provision --workset          # Graph for changed files   aud\n  terraform provision --output graph.json # Custom output path\n\n  Prerequisites:   - Must run 'aud index' first to extract Terraform resources\n  - Terraform files must be in project (.tf, .tfvars)\n\n  Output:   .pf/graphs.db                      # Graph stored with type\n  'terraform_provisioning'   .pf/raw/terraform_graph.json       # JSON export of\n  graph structure\n\n  Graph Structure:   Nodes:     - Variables (source n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.2899000139441341
    },
    {
      "command": "aud terraform report",
      "is_group": false,
      "params": [
        {
          "name": "format",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "text",
          "help_text": "Output format",
          "choices": [
            "text",
            "json",
            "markdown"
          ]
        },
        {
          "name": "output",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Output file path (stdout if not specified)",
          "choices": null
        },
        {
          "name": "severity",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "all",
          "help_text": "Minimum severity to report",
          "choices": [
            "critical",
            "high",
            "medium",
            "low",
            "all"
          ]
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.7182999979704618,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli terraform report [OPTIONS]\n\n  Generate Terraform security report.\n\n  [PHASE 7 - NOT YET IMPLEMENTED]\n\n  Generates a comprehensive report of infrastructure security findings including\n  blast radius analysis and remediation recommendations.\n\n  Examples:   aud terraform report                       # Text report to stdout\n  aud terraform report --format json         # JSON export   aud terraform\n  report --output report.md --format markdown\n\n  Prerequisites:   - Run 'aud terraform analyze' first to generate findings\n\n  This command will be implemented in Phase 7.\n\nOptions:\n  --format [text|json|markdown]   Output format\n  --output TEXT                   Output file path (stdout if not specified)\n  --severity [critical|high|medium|low|all]\n                                  Minimum severity to report\n  --help                          Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.177300000563264
    },
    {
      "command": "aud tools check",
      "is_group": false,
      "params": [
        {
          "name": "strict",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Fail if any tool is missing",
          "choices": null
        },
        {
          "name": "required",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Specific tools to require (can be repeated)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.8137999975588173,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli tools check [OPTIONS]\n\n  Verify required tools are installed.\n\n  Returns exit code 0 if all required tools are available, 1 otherwise. By\n  default, only checks core tools (python, ruff, node, eslint).\n\n  EXAMPLES:\n    aud tools check                    # Check core tools\n    aud tools check --strict           # Fail if ANY tool missing\n    aud tools check --required semgrep # Require specific tool\n\nOptions:\n  --strict         Fail if any tool is missing\n  --required TEXT  Specific tools to require (can be repeated)\n  --help           Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.1808999988716096
    },
    {
      "command": "aud tools list",
      "is_group": false,
      "params": [
        {
          "name": "as_json",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Output as JSON",
          "choices": null
        },
        {
          "name": "category",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "all",
          "help_text": "Filter by category",
          "choices": [
            "python",
            "node",
            "rust",
            "all"
          ]
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.6465000042226166,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli tools list [OPTIONS]\n\n  Show all tools and their versions.\n\n  Displays installed analysis tools with version information and installation\n  source (system or sandbox).\n\nOptions:\n  --json                          Output as JSON\n  --category [python|node|rust|all]\n                                  Filter by category\n  --help                          Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.9971999970730394
    },
    {
      "command": "aud tools report",
      "is_group": false,
      "params": [
        {
          "name": "out_dir",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".pf/raw",
          "help_text": "Output directory",
          "choices": null
        },
        {
          "name": "fmt",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "all",
          "help_text": "Output format",
          "choices": [
            "all",
            "json",
            "markdown"
          ]
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.6250000151339918,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli tools report [OPTIONS]\n\n  Generate tool version report files.\n\n  Creates machine-readable (JSON) and human-readable (Markdown) reports of all\n  detected tool versions.\n\n  OUTPUT FILES:\n    {out_dir}/tools.json   Machine-readable version data\n    {out_dir}/TOOLS.md     Human-readable report\n\nOptions:\n  --out-dir PATH                Output directory\n  --format [all|json|markdown]  Output format\n  --help                        Show this message and exit.\n",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.9753000049386173
    },
    {
      "command": "aud workflows analyze",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory to analyze",
          "choices": null
        },
        {
          "name": "workset",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Analyze workset files only",
          "choices": null
        },
        {
          "name": "severity",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "all",
          "help_text": "Minimum severity to report",
          "choices": [
            "critical",
            "high",
            "medium",
            "low",
            "all"
          ]
        },
        {
          "name": "output",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/raw/github_workflows.json",
          "help_text": "Output JSON path",
          "choices": null
        },
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "./.pf/repo_index.db",
          "help_text": "Database path",
          "choices": null
        },
        {
          "name": "chunk_size",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": 60000,
          "help_text": "Max chunk size for AI consumption (bytes)",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 0.8613999816589057,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli workflows analyze [OPTIONS]\n\n  Analyze GitHub Actions workflows for security issues.\n\n  Extracts workflow data from the database and generates AI-optimized reports\n  for vulnerability analysis. Combines workflow structure data with security\n  findings from rules.\n\n  The analysis includes: - Workflow triggers and permissions - Job dependencies\n  and execution order - Step-level action usage and versions - Secret and\n  credential exposure - External dependency risks\n\n  Examples:   aud workflows analyze                      # Analyze all workflows\n  aud workflows analyze --workset            # Changed files only   aud\n  workflows analyze --severity critical  # Critical findings only   aud\n  workflows analyze --output report.json # Custom output path\n\n  Prerequisites:   - Must run 'aud index' first to extract workflows   -\n  Optionally run 'aud detect-patterns' for security findings\n\n  Output Files:   .pf/raw/github_workflows.json      # Complete workflow\n  analysis   .pf/readth",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 1.2639000196941197
    },
    {
      "command": "aud workset",
      "is_group": false,
      "params": [
        {
          "name": "root",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": ".",
          "help_text": "Root directory",
          "choices": null
        },
        {
          "name": "db",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Input SQLite database path",
          "choices": null
        },
        {
          "name": "manifest",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Input manifest file path",
          "choices": null
        },
        {
          "name": "all",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Include all source files (ignores common directories)",
          "choices": null
        },
        {
          "name": "diff",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Git diff range (e.g., main..HEAD)",
          "choices": null
        },
        {
          "name": "files",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Explicit file list",
          "choices": null
        },
        {
          "name": "include",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Include glob patterns",
          "choices": null
        },
        {
          "name": "exclude",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": "Sentinel.UNSET",
          "help_text": "Exclude glob patterns",
          "choices": null
        },
        {
          "name": "max_depth",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Maximum dependency depth",
          "choices": null
        },
        {
          "name": "out",
          "param_type": "Option",
          "required": false,
          "is_flag": false,
          "default": null,
          "help_text": "Output workset file path",
          "choices": null
        },
        {
          "name": "print_stats",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Print summary statistics",
          "choices": null
        }
      ],
      "help_test": {
        "status": "PASS",
        "exit_code": 0,
        "duration_ms": 2.4799999955575913,
        "failure_category": "none",
        "error_message": null,
        "stdout": "Usage: cli workset [OPTIONS]\n\n  Compute targeted file subset for incremental analysis based on git changes or\n  patterns.\n\n  Performance optimization tool that creates a focused subset of files for\n  analysis instead of re-analyzing your entire codebase. Integrates with git\n  diff to automatically identify changed files, then expands to include\n  dependent files that could be affected by those changes using the import graph\n  from repo_index.db.\n\n  This enables 10-100x faster analysis for PR reviews, commit validations, and\n  iterative development workflows. The workset is saved to .pf/workset.json and\n  consumed by other commands via the --workset flag.\n\n  AI ASSISTANT CONTEXT:   Purpose: Creates focused file subset for targeted\n  analysis (incremental workflows)   Input: Git diff / file patterns +\n  .pf/repo_index.db (import graph)   Output: .pf/workset.json (seed files +\n  expanded dependencies)   Prerequisites: aud index (for dependency expansion),\n  git repository (for --diff)   I",
        "stderr": null
      },
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 2.9012000013608485
    },
    {
      "command": "aud cdk",
      "is_group": true,
      "params": [
        {
          "name": "help",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show this message and exit.",
          "choices": null
        }
      ],
      "help_test": null,
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.0
    },
    {
      "command": "aud cfg",
      "is_group": true,
      "params": [
        {
          "name": "help",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show this message and exit.",
          "choices": null
        }
      ],
      "help_test": null,
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.0
    },
    {
      "command": "aud graph",
      "is_group": true,
      "params": [
        {
          "name": "help",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show this message and exit.",
          "choices": null
        }
      ],
      "help_test": null,
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.0
    },
    {
      "command": "aud graphql",
      "is_group": true,
      "params": [
        {
          "name": "help",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show this message and exit.",
          "choices": null
        }
      ],
      "help_test": null,
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.0
    },
    {
      "command": "aud metadata",
      "is_group": true,
      "params": [
        {
          "name": "help",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show this message and exit.",
          "choices": null
        }
      ],
      "help_test": null,
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.0
    },
    {
      "command": "aud planning",
      "is_group": true,
      "params": [
        {
          "name": "help",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show this message and exit.",
          "choices": null
        }
      ],
      "help_test": null,
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.0
    },
    {
      "command": "aud session",
      "is_group": true,
      "params": [],
      "help_test": null,
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.0
    },
    {
      "command": "aud terraform",
      "is_group": true,
      "params": [
        {
          "name": "help",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show this message and exit.",
          "choices": null
        }
      ],
      "help_test": null,
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.0
    },
    {
      "command": "aud tools",
      "is_group": true,
      "params": [],
      "help_test": null,
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.0
    },
    {
      "command": "aud workflows",
      "is_group": true,
      "params": [
        {
          "name": "help",
          "param_type": "Option",
          "required": false,
          "is_flag": true,
          "default": false,
          "help_text": "Show this message and exit.",
          "choices": null
        }
      ],
      "help_test": null,
      "no_args_test": null,
      "fixture_tests": {},
      "total_duration_ms": 0.0
    }
  ]
}