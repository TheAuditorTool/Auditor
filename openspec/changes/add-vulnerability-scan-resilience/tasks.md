## 0. Verification (SOP v4.20)
- [ ] 0.1 Re-read 	eamsop.md, openspec/project.md, and this change's erification.md before editing code.
- [ ] 0.2 Reconfirm evidence in erification.md after touching schema.py, indexer extractors, or vulnerability scanner logic.
- [ ] 0.3 Capture before/after database snapshots on fixtures (Python-only, Node-only) to prove the new tables populate as expected.

## 1. Schema & Manifest Inventory
- [ ] 1.1 Design and apply migrations for package_dependencies and dependency_manifests tables in 	heauditor/indexer/schema.py and database.py.
- [ ] 1.2 Implement safe backfill/cleanup logic so reindexing replaces stale rows without leaving orphan records.
- [ ] 1.3 Add schema contract/tests ensuring both tables validate under 	ests/test_schema_contract.py.

## 2. Indexer Extractors & Writers
- [ ] 2.1 Build Python manifest extractors (requirements, pip-tools, pyproject) that populate package_dependencies without regex heuristics.
- [ ] 2.2 Update existing Node extractors to emit per-dependency rows alongside the summary stored in package_configs.
- [ ] 2.3 Record manifest provenance (hash, manager, parsed_at) in dependency_manifests and wire IndexerOrchestrator to flush batches atomically.

## 3. Vulnerability Scanner Resilience
- [ ] 3.1 Teach _load_packages_from_db to read the new tables and reconcile with parsed manifests, including manifest hashes from dependency_manifests.
- [ ] 3.2 Add per-tool timing (started_at, nded_at, duration_ms) plus attempt counters to 	ool_status, surfacing retries and outcomes in logs and JSON.
- [ ] 3.3 Implement single automatic retry for transient subprocess failures and capture stderr/stdout summaries for post-mortem review.
- [ ] 3.4 Preserve every CWE ID in findings (JSON and indings_consolidated), adding a join table or JSON column as required by schema constraints.
- [ ] 3.5 Expand JSON artifact schema to include 	ool_status timings, retry metadata, and cwe_ids arrays while keeping backward compatibility for consumers.

## 4. Downstream Consumers & Telemetry
- [ ] 4.1 Update FCE and any rules consuming CWE data to accept arrays without regressing existing analyses.
- [ ] 4.2 Publish scan telemetry into .pf/status/vulnerability-scan.status with total duration, per-tool durations, and retry results.
- [ ] 4.3 Ensure pipeline summaries and CLI output reference the new telemetry fields.

## 5. Tests, Docs, and Validation
- [ ] 5.1 Add unit tests for new extractors, schema migrations, retry helpers, and CWE serialization.
- [ ] 5.2 Add integration tests that run ud index + ud deps --vuln-scan across Python-only and mixed repositories, asserting database contents, telemetry, retries, and JSON schema.
- [ ] 5.3 Update documentation (README, security guides) to describe the manifest inventory tables, telemetry, and retry behavior.
- [ ] 5.4 Run openspec validate add-vulnerability-scan-resilience --strict and the full quality gate (pytest, uff, mypy --strict).